<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖŸÅÿ±ÿØÿ©</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Arial', 'Tahoma', sans-serif;
                font-size: 22px;
                line-height: 1.6;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
                direction: rtl;
                color: #333;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
                background: white;
                border-radius: 20px;
                padding: 30px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
            }

            .title {
                font-size: 36px;
                color: #4a5568;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }

            .subtitle {
                font-size: 20px;
                color: #718096;
                margin-bottom: 20px;
            }

            .level-selector {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-bottom: 30px;
                flex-wrap: wrap;
            }

            .level-btn {
                padding: 15px 30px;
                font-size: 20px;
                border: 3px solid #4299e1;
                background: white;
                color: #4299e1;
                border-radius: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 150px;
            }

            .level-btn:hover,
            .level-btn.active {
                background: #4299e1;
                color: white;
                transform: scale(1.05);
            }

            .start-btn {
                padding: 20px 40px;
                font-size: 24px;
                background: #48bb78;
                color: white;
                border: none;
                border-radius: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .start-btn:hover {
                background: #38a169;
                transform: scale(1.05);
            }

            .game-area {
                display: none;
                text-align: center;
            }

            .progress-bar {
                background: #e2e8f0;
                border-radius: 10px;
                height: 15px;
                margin-bottom: 30px;
                overflow: hidden;
            }

            .progress-fill {
                background: linear-gradient(90deg, #48bb78, #38a169);
                height: 100%;
                transition: width 0.5s ease;
                border-radius: 10px;
            }

            .card-counter {
                font-size: 18px;
                color: #4a5568;
                margin-bottom: 20px;
            }

            .card-display {
                background: #f7fafc;
                border-radius: 20px;
                padding: 40px;
                margin-bottom: 30px;
                border: 3px solid #e2e8f0;
            }

            .emoji-display {
                font-size: 120px;
                margin-bottom: 20px;
                display: block;
            }

            .word-display {
                font-size: 48px;
                color: #2d3748;
                margin-bottom: 20px;
                font-weight: bold;
                min-height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .question {
                font-size: 24px;
                color: #4a5568;
                margin-bottom: 20px;
                font-weight: bold;
            }

            .input-area {
                margin-bottom: 30px;
            }

            .text-input {
                width: 100%;
                max-width: 400px;
                padding: 15px;
                font-size: 20px;
                border: 3px solid #cbd5e0;
                border-radius: 10px;
                text-align: center;
                direction: rtl;
            }

            .text-input:focus {
                outline: none;
                border-color: #4299e1;
            }

            .choices {
                display: flex;
                justify-content: center;
                gap: 20px;
                flex-wrap: wrap;
                margin-top: 20px;
            }

            .choice-btn {
                padding: 15px 25px;
                font-size: 20px;
                border: 3px solid #4299e1;
                background: white;
                color: #4299e1;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 150px;
            }

            .choice-btn:hover {
                background: #4299e1;
                color: white;
            }

            .choice-btn.correct {
                background: #48bb78;
                border-color: #48bb78;
                color: white;
            }

            .choice-btn.incorrect {
                background: #f56565;
                border-color: #f56565;
                color: white;
            }

            .action-buttons {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin: 20px 0;
                flex-wrap: wrap;
            }

            .btn {
                padding: 15px 25px;
                font-size: 18px;
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .btn-primary {
                background: #4299e1;
                color: white;
            }

            .btn-primary:hover {
                background: #3182ce;
            }

            .btn-secondary {
                background: #a0aec0;
                color: white;
            }

            .btn-secondary:hover {
                background: #718096;
            }

            .btn-success {
                background: #48bb78;
                color: white;
            }

            .btn-success:hover {
                background: #38a169;
            }

            .message {
                padding: 20px;
                margin: 20px 0;
                border-radius: 10px;
                font-size: 20px;
                text-align: center;
                font-weight: bold;
            }

            .message.success {
                background: #c6f6d5;
                color: #22543d;
                border: 2px solid #48bb78;
            }

            .message.error {
                background: #fed7d7;
                color: #742a2a;
                border: 2px solid #f56565;
            }

            .message.hint {
                background: #fef5e7;
                color: #744210;
                border: 2px solid #ed8936;
            }

            .score {
                font-size: 20px;
                color: #4a5568;
                margin-bottom: 20px;
            }

            .sentence-display {
                font-size: 24px;
                color: #2d3748;
                margin: 20px 0;
                padding: 20px;
                background: #edf2f7;
                border-radius: 10px;
                border-right: 5px solid #4299e1;
            }

            .hidden {
                display: none !important;
            }

            @media (max-width: 768px) {
                .container {
                    padding: 20px;
                    margin: 10px;
                }

                .title {
                    font-size: 28px;
                }

                .emoji-display {
                    font-size: 80px;
                }

                .word-display {
                    font-size: 32px;
                }

                .level-selector,
                .choices {
                    flex-direction: column;
                    align-items: center;
                }
            }

            /* Accessibility improvements */
            .sr-only {
                position: absolute;
                width: 1px;
                height: 1px;
                padding: 0;
                margin: -1px;
                overflow: hidden;
                clip: rect(0, 0, 0, 0);
                white-space: nowrap;
                border: 0;
            }

            *:focus {
                outline: 3px solid #4299e1;
                outline-offset: 2px;
            }

            .glitter-effect {
                position: fixed;
                pointer-events: none;
                z-index: 1000;
            }

            .glitter-particle {
                position: absolute;
                width: 10px;
                height: 10px;
                background: #ffd700;
                border-radius: 50%;
                animation: glitter 1s ease-out forwards;
            }

            @keyframes glitter {
                0% {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                100% {
                    transform: translateY(-100px) scale(0);
                    opacity: 0;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1 class="title">üéØ ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖŸÅÿ±ÿØÿ©</h1>
                <p class="subtitle">ŸÑÿπÿ®ÿ© ÿ™ÿπŸÑŸäŸÖŸäÿ© ŸÖŸÖÿ™ÿπÿ© ŸÑÿ™ÿπŸÑŸÖ ÿßŸÑŸÉŸÑŸÖÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ©</p>
            </div>

            <div id="menu" class="menu-area">
                <div class="level-selector">
                    <button class="level-btn" data-level="1">ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ£ŸàŸÑ<br /><small>ÿ£ÿ¥Ÿäÿßÿ° ŸÖÿ£ŸÑŸàŸÅÿ©</small></button>
                    <button class="level-btn" data-level="2">ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ´ÿßŸÜŸä<br /><small>ÿ£ŸÅÿπÿßŸÑ Ÿàÿ£ŸàÿµÿßŸÅ</small></button>
                    <button class="level-btn" data-level="3">ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ´ÿßŸÑÿ´<br /><small>ÿ£ŸÖÿßŸÉŸÜ ŸàŸÖÿ¥ÿßÿπÿ±</small></button>
                </div>
                <div style="text-align: center">
                    <button id="startGame" class="start-btn">üöÄ ÿßÿ®ÿØÿ£ ÿßŸÑŸÑÿπÿ®ÿ©</button>
                </div>
            </div>

            <div id="gameArea" class="game-area">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>

                <div class="card-counter">
                    <span id="cardCounter">ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© 1 ŸÖŸÜ 6</span>
                    <span class="score">ÿßŸÑŸÜŸÇÿßÿ∑: <span id="score">0</span></span>
                </div>

                <div class="card-display">
                    <div id="emojiDisplay" class="emoji-display" role="img"></div>
                    <div id="wordDisplay" class="word-display"></div>
                    <div id="question" class="question"></div>
                </div>

                <div id="inputArea" class="input-area">
                    <input type="text" id="textInput" class="text-input" placeholder="ÿßŸÉÿ™ÿ® ÿ•ÿ¨ÿßÿ®ÿ™ŸÉ ŸáŸÜÿß..." aria-label="ŸÖŸÉÿßŸÜ ŸÉÿ™ÿßÿ®ÿ© ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©" />
                    <div id="choices" class="choices"></div>
                </div>

                <div class="action-buttons">
                    <button id="checkBtn" class="btn btn-primary">‚úÖ ÿ™ÿ≠ŸÇŸÇ</button>
                    <button id="showWordBtn" class="btn btn-secondary">üëÅÔ∏è ÿ£ÿ∏Ÿáÿ± ÿßŸÑŸÉŸÑŸÖÿ©</button>
                    <button id="speakBtn" class="btn btn-success">üîä ÿßŸÜÿ∑ŸÇ</button>
                    <button id="nextBtn" class="btn btn-primary hidden">‚è≠Ô∏è ÿßŸÑÿ™ÿßŸÑŸä</button>
                </div>

                <div id="message" class="message hidden" role="status" aria-live="polite"></div>
                <div id="sentenceDisplay" class="sentence-display hidden"></div>

                <div style="text-align: center; margin-top: 30px">
                    <button id="endGameBtn" class="btn btn-secondary">üè† ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÑÿπÿ®ÿ©</button>
                </div>
            </div>
        </div>

        <script>
            // ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ´ÿßÿ®ÿ™ÿ© ŸÑŸÑŸÖÿ≥ÿ™ŸàŸäÿßÿ™ ÿßŸÑÿ´ŸÑÿßÿ´ÿ©
            const LEVEL1 = [
                { word: 'ÿØÿ±ÿßÿ¨ÿ©', emoji: 'üö≤', sentence: 'ÿ£ŸÜÿß ÿ£ÿ±ŸÉÿ® ÿßŸÑÿØÿ±ÿßÿ¨ÿ© ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ©.', question: 'ÿ£ŸäŸÜ ŸÜÿ±ŸÉÿ® ÿßŸÑÿØÿ±ÿßÿ¨ÿ© ÿπÿßÿØÿ©ÿü', answers: ['ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ©', 'ŸÅŸä ÿßŸÑÿ≥ŸÖÿßÿ°'], synonyms: ['ÿ®ÿ≥ŸÉŸÑÿ™Ÿá', 'ÿ®ÿ≥ŸÉŸÑŸäÿ™'], hint: 'ŸÖÿ±ŸÉÿ®ÿ© ŸÑŸáÿß ÿπÿ¨ŸÑÿ™ÿßŸÜ.' },
                { word: 'ŸÉÿ±ÿ©', emoji: '‚öΩ', sentence: 'ŸÜŸÑÿπÿ® ÿ®ÿßŸÑŸÉÿ±ÿ© ŸÅŸä ÿßŸÑŸÖŸÑÿπÿ®.', question: 'ŸÖÿßÿ∞ÿß ŸÜŸÅÿπŸÑ ÿ®ÿßŸÑŸÉÿ±ÿ©ÿü', answers: ['ŸÜŸÑÿπÿ®', 'ŸÜÿ£ŸÉŸÑ'], synonyms: ['ÿ∑ÿßÿ®ÿ©'], hint: 'ÿ¥Ÿäÿ° ŸÖÿ≥ÿ™ÿØŸäÿ± ŸÜŸÑÿπÿ® ÿ®Ÿá.' },
                { word: 'ÿ™ŸÅÿßÿ≠ÿ©', emoji: 'üçé', sentence: 'ÿ£ÿ≠ÿ® ÿ£ŸÉŸÑ ÿßŸÑÿ™ŸÅÿßÿ≠ÿ© ÿßŸÑÿ≠ŸÖÿ±ÿßÿ°.', question: 'ŸÖÿß ŸÑŸàŸÜ ÿßŸÑÿ™ŸÅÿßÿ≠ÿ©ÿü', answers: ['ÿ£ÿ≠ŸÖÿ±', 'ÿ£ÿ≤ÿ±ŸÇ'], synonyms: ['ÿ™ŸÅÿßÿ≠'], hint: 'ŸÅÿßŸÉŸáÿ© ÿ≠ŸÖÿ±ÿßÿ° ÿ£Ÿà ÿÆÿ∂ÿ±ÿßÿ°.' },
                { word: 'ŸÇÿ∑ÿ©', emoji: 'üê±', sentence: 'ÿßŸÑŸÇÿ∑ÿ© ÿ™ÿ¥ÿ±ÿ® ÿßŸÑÿ≠ŸÑŸäÿ®.', question: 'ŸÖÿßÿ∞ÿß ÿ™ÿ¥ÿ±ÿ® ÿßŸÑŸÇÿ∑ÿ©ÿü', answers: ['ÿßŸÑÿ≠ŸÑŸäÿ®', 'ÿßŸÑÿπÿµŸäÿ±'], synonyms: ['ŸÇÿ∑', 'Ÿáÿ±ÿ©'], hint: 'ÿ≠ŸäŸàÿßŸÜ ÿ£ŸÑŸäŸÅ ŸäŸÖŸàÿ°.' },
                { word: 'ŸÉÿ±ÿ≥Ÿä', emoji: 'ü™ë', sentence: 'ÿ£ÿ¨ŸÑÿ≥ ÿπŸÑŸâ ÿßŸÑŸÉÿ±ÿ≥Ÿä ŸÑŸÑÿØÿ±ÿßÿ≥ÿ©.', question: 'ŸÑŸÖÿßÿ∞ÿß ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑŸÉÿ±ÿ≥Ÿäÿü', answers: ['ŸÑŸÑÿ¨ŸÑŸàÿ≥', 'ŸÑŸÑÿ£ŸÉŸÑ'], synonyms: ['ŸÖŸÇÿπÿØ'], hint: 'ŸÜÿ¨ŸÑÿ≥ ÿπŸÑŸäŸá.' },
                { word: 'ŸÉÿ™ÿßÿ®', emoji: 'üìñ', sentence: 'ÿ£ŸÇÿ±ÿ£ ÿßŸÑŸÉÿ™ÿßÿ® ŸÉŸÑ ŸäŸàŸÖ.', question: 'ŸÖÿßÿ∞ÿß ŸÜŸÅÿπŸÑ ÿ®ÿßŸÑŸÉÿ™ÿßÿ®ÿü', answers: ['ŸÜŸÇÿ±ÿ£', 'ŸÜÿ±ÿ≥ŸÖ'], synonyms: [], hint: 'ŸÜŸÇÿ±ÿ£ ŸÖŸÜŸá ÿßŸÑŸÇÿµÿµ.' },
                { word: 'ÿ¥ÿ¨ÿ±ÿ©', emoji: 'üå≥', sentence: 'ÿßŸÑÿ¥ÿ¨ÿ±ÿ© ÿßŸÑŸÉÿ®Ÿäÿ±ÿ© ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ©.', question: 'ÿ£ŸäŸÜ ÿ™Ÿàÿ¨ÿØ ÿßŸÑÿ¥ÿ¨ÿ±ÿ©ÿü', answers: ['ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ©', 'ŸÅŸä ÿßŸÑÿ®ÿ≠ÿ±'], synonyms: [], hint: 'ŸÜÿ®ÿßÿ™ ŸÉÿ®Ÿäÿ± ŸÑŸá ÿ£Ÿàÿ±ÿßŸÇ ÿÆÿ∂ÿ±ÿßÿ°.' },
                { word: 'ÿ≥Ÿäÿßÿ±ÿ©', emoji: 'üöó', sentence: 'ŸÜÿ≥ÿßŸÅÿ± ÿ®ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©.', question: 'ŸÉŸäŸÅ ŸÜÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑŸÖÿØÿ±ÿ≥ÿ©ÿü', answers: ['ÿ®ÿßŸÑÿ≥Ÿäÿßÿ±ÿ©', 'ÿ®ÿßŸÑÿ∑ÿßÿ¶ÿ±ÿ©'], synonyms: ['ÿπÿ±ÿ®ÿ©'], hint: 'ŸÖÿ±ŸÉÿ®ÿ© ŸÑŸáÿß ÿ£ÿ±ÿ®ÿπ ÿπÿ¨ŸÑÿßÿ™.' },
                { word: 'ŸÉŸàÿ®', emoji: 'ü•§', sentence: 'ÿ£ÿ¥ÿ±ÿ® ÿßŸÑŸÖÿßÿ° ŸÖŸÜ ÿßŸÑŸÉŸàÿ®.', question: 'ŸÖÿßÿ∞ÿß ŸÜÿ¥ÿ±ÿ® ŸÖŸÜ ÿßŸÑŸÉŸàÿ®ÿü', answers: ['ÿßŸÑŸÖÿßÿ°', 'ÿßŸÑÿÆÿ®ÿ≤'], synonyms: ['ŸÉÿ£ÿ≥'], hint: 'ŸÜÿ¥ÿ±ÿ® ŸÖŸÜŸá ÿßŸÑŸÖÿßÿ°.' },
                { word: 'ÿ≠ÿ∞ÿßÿ°', emoji: 'üëü', sentence: 'ÿ£ŸÑÿ®ÿ≥ ÿßŸÑÿ≠ÿ∞ÿßÿ° ŸÇÿ®ŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨.', question: 'ŸÖÿ™Ÿâ ŸÜŸÑÿ®ÿ≥ ÿßŸÑÿ≠ÿ∞ÿßÿ°ÿü', answers: ['ŸÇÿ®ŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨', 'ÿπŸÜÿØ ÿßŸÑŸÜŸàŸÖ'], synonyms: ['ÿ¨ÿ≤ŸÖÿ©'], hint: 'ŸÜŸÑÿ®ÿ≥Ÿá ŸÅŸä ŸÇÿØŸÖŸÜÿß.' }
            ];

            const LEVEL2 = [
                { word: 'Ÿäÿ±ŸÉÿ∂', emoji: 'üèÉ‚Äç‚ôÇÔ∏è', sentence: 'ÿßŸÑŸàŸÑÿØ Ÿäÿ±ŸÉÿ∂ ÿ®ÿ≥ÿ±ÿπÿ©.', question: 'ŸáŸÑ Ÿäÿ±ŸÉÿ∂ ÿßŸÑŸàŸÑÿØ ÿ£ŸÖ Ÿäÿ¨ŸÑÿ≥ÿü', answers: ['Ÿäÿ±ŸÉÿ∂', 'Ÿäÿ¨ŸÑÿ≥'], synonyms: ['Ÿäÿ¨ÿ±Ÿä'], hint: 'Ÿäÿ™ÿ≠ÿ±ŸÉ ÿ®ÿ≥ÿ±ÿπÿ© ÿπŸÑŸâ ŸÇÿØŸÖŸäŸá.' },
                { word: 'Ÿäÿ£ŸÉŸÑ', emoji: 'üçΩÔ∏è', sentence: 'ÿ£ŸÜÿß ÿ¢ŸÉŸÑ ÿ™ŸÅÿßÿ≠ÿ©.', question: 'ŸÖÿßÿ∞ÿß ÿ¢ŸÉŸÑÿü', answers: ['ÿ™ŸÅÿßÿ≠ÿ©', 'ŸÉÿ™ÿßÿ®'], synonyms: [], hint: 'ŸÜÿ∂ÿπ ÿßŸÑÿ∑ÿπÿßŸÖ ŸÅŸä ÿßŸÑŸÅŸÖ.' },
                { word: 'ŸäŸÅÿ™ÿ≠', emoji: 'üîì', sentence: 'ŸÜŸÅÿ™ÿ≠ ÿßŸÑÿ®ÿßÿ®.', question: 'ŸÖÿßÿ∞ÿß ŸÜŸÅÿ™ÿ≠ÿü', answers: ['ÿßŸÑÿ®ÿßÿ®', 'ÿßŸÑÿ≥ŸÖÿßÿ°'], synonyms: [], hint: 'ÿπŸÉÿ≥ ŸäŸèÿ∫ŸÑŸÇ.' },
                { word: 'ŸÉÿ®Ÿäÿ±', emoji: 'üìè', sentence: 'Ÿáÿ∞ÿß ÿµŸÜÿØŸàŸÇ ŸÉÿ®Ÿäÿ±.', question: 'ŸáŸÑ ÿßŸÑÿµŸÜÿØŸàŸÇ ŸÉÿ®Ÿäÿ± ÿ£ŸÖ ÿµÿ∫Ÿäÿ±ÿü', answers: ['ŸÉÿ®Ÿäÿ±', 'ÿµÿ∫Ÿäÿ±'], synonyms: ['ÿ∂ÿÆŸÖ'], hint: 'ÿπŸÉÿ≥ ÿµÿ∫Ÿäÿ±.' },
                { word: 'ÿ≥ÿ±Ÿäÿπ', emoji: 'üêá', sentence: 'ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ÿ≥ÿ±Ÿäÿπÿ©.', question: 'ŸáŸÑ ÿßŸÑÿ≥Ÿäÿßÿ±ÿ© ÿ®ÿ∑Ÿäÿ¶ÿ©ÿü', answers: ['ŸÑÿß', 'ŸÜÿπŸÖ'], synonyms: [], hint: 'ÿπŸÉÿ≥ ÿ®ÿ∑Ÿäÿ°.' },
                { word: 'Ÿäÿ∂ÿ≠ŸÉ', emoji: 'üòÇ', sentence: 'ÿßŸÑÿ∑ŸÅŸÑ Ÿäÿ∂ÿ≠ŸÉ ŸÖŸÜ ŸÅÿ±ÿ≠ÿ™Ÿá.', question: 'ŸÑŸÖÿßÿ∞ÿß Ÿäÿ∂ÿ≠ŸÉ ÿßŸÑÿ∑ŸÅŸÑÿü', answers: ['ŸÖŸÜ ŸÅÿ±ÿ≠ÿ™Ÿá', 'ŸÖŸÜ ÿ≠ÿ≤ŸÜŸá'], synonyms: [], hint: 'ŸÜŸÅÿπŸÑŸá ÿπŸÜÿØŸÖÿß ŸÜŸÉŸàŸÜ ÿ≥ÿπÿØÿßÿ°.' },
                { word: 'Ÿäÿ±ÿ≥ŸÖ', emoji: 'üé®', sentence: 'ÿßŸÑÿ®ŸÜÿ™ ÿ™ÿ±ÿ≥ŸÖ ÿµŸàÿ±ÿ© ÿ¨ŸÖŸäŸÑÿ©.', question: 'ŸÖÿßÿ∞ÿß ÿ™ÿ±ÿ≥ŸÖ ÿßŸÑÿ®ŸÜÿ™ÿü', answers: ['ÿµŸàÿ±ÿ©', 'ŸÉÿ™ÿßÿ®'], synonyms: [], hint: 'ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑŸÇŸÑŸÖ ŸàÿßŸÑŸàÿ±ŸÇ.' },
                { word: 'ÿ£ÿ≠ŸÖÿ±', emoji: 'üî¥', sentence: 'Ÿáÿ∞ÿß ÿ™ŸÅÿßÿ≠ ÿ£ÿ≠ŸÖÿ±.', question: 'ŸÖÿß ŸÑŸàŸÜ ÿßŸÑÿ™ŸÅÿßÿ≠ÿü', answers: ['ÿ£ÿ≠ŸÖÿ±', 'ÿ£ÿ≥ŸàÿØ'], synonyms: [], hint: 'ŸÑŸàŸÜ ÿßŸÑŸÜÿßÿ±.' },
                { word: 'Ÿäÿ∫ŸÜŸä', emoji: 'üéµ', sentence: 'ÿßŸÑÿ∑ÿßÿ¶ÿ± Ÿäÿ∫ŸÜŸä ŸÅŸä ÿßŸÑÿµÿ®ÿßÿ≠.', question: 'ŸÖÿ™Ÿâ Ÿäÿ∫ŸÜŸä ÿßŸÑÿ∑ÿßÿ¶ÿ±ÿü', answers: ['ŸÅŸä ÿßŸÑÿµÿ®ÿßÿ≠', 'ŸÅŸä ÿßŸÑŸÑŸäŸÑ'], synonyms: [], hint: 'ŸäÿµÿØÿ± ÿ£ÿµŸàÿßÿ™ÿßŸã ÿ¨ŸÖŸäŸÑÿ©.' },
                { word: 'ŸÜÿ∏ŸäŸÅ', emoji: 'üßº', sentence: 'ÿßŸÑÿ´Ÿàÿ® ŸÜÿ∏ŸäŸÅ Ÿàÿ¨ŸÖŸäŸÑ.', question: 'ŸÉŸäŸÅ ÿßŸÑÿ´Ÿàÿ®ÿü', answers: ['ŸÜÿ∏ŸäŸÅ', 'ŸÖÿ™ÿ≥ÿÆ'], synonyms: ['ÿ∑ÿßŸáÿ±'], hint: 'ÿπŸÉÿ≥ ŸÖÿ™ÿ≥ÿÆ.' }
            ];

            const LEVEL3 = [
                { word: 'ÿ≠ÿØŸäŸÇÿ©', emoji: 'üåº', sentence: 'ŸÜŸÑÿπÿ® ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ© ÿßŸÑÿ¨ŸÖŸäŸÑÿ©.', question: 'ÿ£ŸäŸÜ ŸÜŸÑÿπÿ®ÿü', answers: ['ŸÅŸä ÿßŸÑÿ≠ÿØŸäŸÇÿ©', 'ŸÅŸä ÿßŸÑÿ®Ÿäÿ™'], synonyms: ['ÿ®ÿ≥ÿ™ÿßŸÜ'], hint: 'ŸÖŸÉÿßŸÜ ŸÅŸäŸá ÿ£ÿ¥ÿ¨ÿßÿ± Ÿàÿ£ÿ≤Ÿáÿßÿ±.' },
                { word: 'ÿ¥ÿßÿ∑ÿ¶', emoji: 'üèñÔ∏è', sentence: 'ŸÜÿ≥ÿ®ÿ≠ ŸÅŸä ÿßŸÑÿ®ÿ≠ÿ± ÿπŸÑŸâ ÿßŸÑÿ¥ÿßÿ∑ÿ¶.', question: 'ÿ£ŸäŸÜ ŸÜÿ≥ÿ®ÿ≠ ŸÅŸä ÿßŸÑÿ®ÿ≠ÿ±ÿü', answers: ['ÿπŸÑŸâ ÿßŸÑÿ¥ÿßÿ∑ÿ¶', 'ŸÅŸä ÿßŸÑÿµÿ≠ÿ±ÿßÿ°'], synonyms: [], hint: 'ŸÖŸÉÿßŸÜ ÿßŸÑÿ™ŸÇÿßÿ° ÿßŸÑÿ®ÿ≠ÿ± ÿ®ÿßŸÑŸäÿßÿ®ÿ≥ÿ©.' },
                { word: 'ŸÖŸÉÿ™ÿ®ÿ©', emoji: 'üìö', sentence: 'ÿ£ŸÇÿ±ÿ£ ÿßŸÑŸÉÿ™ÿ® ŸÅŸä ÿßŸÑŸÖŸÉÿ™ÿ®ÿ©.', question: 'ÿ£ŸäŸÜ ÿ£ŸÇÿ±ÿ£ ÿßŸÑŸÉÿ™ÿ®ÿü', answers: ['ŸÅŸä ÿßŸÑŸÖŸÉÿ™ÿ®ÿ©', 'ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ'], synonyms: [], hint: 'ŸÖŸÉÿßŸÜ ŸÅŸäŸá ŸÉÿ™ÿ® ŸÉÿ´Ÿäÿ±ÿ©.' },
                { word: 'ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ', emoji: 'üè•', sentence: 'ŸÜÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿπŸÜÿØ ÿßŸÑŸÖÿ±ÿ∂.', question: 'ŸÖÿ™Ÿâ ŸÜÿ∞Ÿáÿ® ÿ•ŸÑŸâ ÿßŸÑŸÖÿ≥ÿ™ÿ¥ŸÅŸâÿü', answers: ['ÿπŸÜÿØ ÿßŸÑŸÖÿ±ÿ∂', 'ÿπŸÜÿØ ÿßŸÑŸÅÿ±ÿ≠'], synonyms: [], hint: 'ŸÖŸÉÿßŸÜ ÿπŸÑÿßÿ¨ ÿßŸÑŸÖÿ±ÿ∂Ÿâ.' },
                { word: 'ÿ≥ÿπÿßÿØÿ©', emoji: 'üòä', sentence: 'ÿ£ÿ¥ÿπÿ± ÿ®ÿßŸÑÿ≥ÿπÿßÿØÿ© ÿπŸÜÿØ ÿßŸÑŸÑÿπÿ®.', question: 'ŸÖÿ™Ÿâ ÿ™ÿ¥ÿπÿ± ÿ®ÿßŸÑÿ≥ÿπÿßÿØÿ©ÿü', answers: ['ÿπŸÜÿØ ÿßŸÑŸÑÿπÿ®', 'ÿπŸÜÿØ ÿßŸÑÿ≠ÿ≤ŸÜ'], synonyms: ['ŸÅÿ±ÿ≠'], hint: 'ÿ¥ÿπŸàÿ± ÿ¨ŸÖŸäŸÑ ÿπŸÉÿ≥ ÿßŸÑÿ≠ÿ≤ŸÜ.' },
                { word: 'ÿÆŸàŸÅ', emoji: 'üò®', sentence: 'ÿ£ÿ¥ÿπÿ± ÿ®ÿßŸÑÿÆŸàŸÅ ŸÖŸÜ ÿßŸÑÿ∏ŸÑÿßŸÖ.', question: 'ŸÖŸÖ ÿ£ÿ¥ÿπÿ± ÿ®ÿßŸÑÿÆŸàŸÅÿü', answers: ['ŸÖŸÜ ÿßŸÑÿ∏ŸÑÿßŸÖ', 'ŸÖŸÜ ÿßŸÑŸÜŸàÿ±'], synonyms: [], hint: 'ÿ¥ÿπŸàÿ± ÿπŸÜÿØŸÖÿß ŸÜÿÆÿßŸÅ.' },
                { word: 'ÿ®ÿ±ŸÉÿßŸÜ', emoji: 'üåã', sentence: 'ÿßŸÑÿ®ÿ±ŸÉÿßŸÜ ÿ¨ÿ®ŸÑ ŸäÿÆÿ±ÿ¨ ŸÖŸÜŸá ŸÜÿßÿ±.', question: 'ŸáŸÑ ÿßŸÑÿ®ÿ±ŸÉÿßŸÜ ŸÖŸÉÿßŸÜ ÿ®ÿßÿ±ÿØÿü', answers: ['ŸÑÿß', 'ŸÜÿπŸÖ'], synonyms: [], hint: 'ÿ¨ÿ®ŸÑ ŸäÿÆÿ±ÿ¨ ŸÖŸÜŸá ŸÜÿßÿ± ŸàÿØÿÆÿßŸÜ.' },
                { word: 'ÿµÿ≠ÿ±ÿßÿ°', emoji: 'üèúÔ∏è', sentence: 'ÿßŸÑÿµÿ≠ÿ±ÿßÿ° ŸÖŸÉÿßŸÜ ŸÅŸäŸá ÿ±ŸÖÿßŸÑ ŸÉÿ´Ÿäÿ±ÿ©.', question: 'ŸÖÿßÿ∞ÿß ŸäŸàÿ¨ÿØ ŸÅŸä ÿßŸÑÿµÿ≠ÿ±ÿßÿ°ÿü', answers: ['ÿ±ŸÖÿßŸÑ', 'ÿ´ŸÑÿ¨'], synonyms: [], hint: 'ŸÖŸÉÿßŸÜ ÿ¨ÿßŸÅ ŸÅŸäŸá ÿ±ŸÖÿßŸÑ.' },
                { word: 'ÿ¨ÿ≥ÿ±', emoji: 'üåâ', sentence: 'ŸÜÿπÿ®ÿ± ÿßŸÑŸÜŸáÿ± ÿπŸÑŸâ ÿßŸÑÿ¨ÿ≥ÿ±.', question: 'ŸÉŸäŸÅ ŸÜÿπÿ®ÿ± ÿßŸÑŸÜŸáÿ±ÿü', answers: ['ÿπŸÑŸâ ÿßŸÑÿ¨ÿ≥ÿ±', 'ÿ™ÿ≠ÿ™ ÿßŸÑŸÖÿßÿ°'], synonyms: [], hint: 'ÿ∑ÿ±ŸäŸÇ ŸäÿπŸÑŸà ÿßŸÑŸÖÿßÿ°.' },
                { word: 'ŸÇŸÑÿπÿ©', emoji: 'üè∞', sentence: 'ÿßŸÑŸÇŸÑÿπÿ© ÿ®ŸÜÿßÿ° ŸÇÿØŸäŸÖ ŸàŸÇŸàŸä.', question: 'ŸÉŸäŸÅ ÿßŸÑÿ®ŸÜÿßÿ° ŸÅŸä ÿßŸÑŸÇŸÑÿπÿ©ÿü', answers: ['ŸÇÿØŸäŸÖ ŸàŸÇŸàŸä', 'ÿ¨ÿØŸäÿØ Ÿàÿ∂ÿπŸäŸÅ'], synonyms: ['ÿ≠ÿµŸÜ'], hint: 'ÿ®ŸÜÿßÿ° ŸÇÿØŸäŸÖ ŸÑŸÑÿ≠ŸÖÿßŸäÿ©.' }
            ];

            // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©
            let currentLevel = 1;
            let currentCards = [];
            let currentCardIndex = 0;
            let score = 0;
            let attempts = 0;
            let audioContext;
            let gamePhase = 'naming'; // 'naming' ÿ£Ÿà 'comprehension'
            let currentCard = null;
            let wordRevealed = false;

            // ÿπŸÜÿßÿµÿ± DOM
            const menuArea = document.getElementById('menu');
            const gameArea = document.getElementById('gameArea');
            const levelButtons = document.querySelectorAll('.level-btn');
            const startGameBtn = document.getElementById('startGame');
            const cardCounter = document.getElementById('cardCounter');
            const scoreDisplay = document.getElementById('score');
            const progressFill = document.getElementById('progressFill');
            const emojiDisplay = document.getElementById('emojiDisplay');
            const wordDisplay = document.getElementById('wordDisplay');
            const questionDisplay = document.getElementById('question');
            const inputArea = document.getElementById('inputArea');
            const textInput = document.getElementById('textInput');
            const choicesDiv = document.getElementById('choices');
            const checkBtn = document.getElementById('checkBtn');
            const showWordBtn = document.getElementById('showWordBtn');
            const speakBtn = document.getElementById('speakBtn');
            const nextBtn = document.getElementById('nextBtn');
            const messageDiv = document.getElementById('message');
            const sentenceDisplay = document.getElementById('sentenceDisplay');
            const endGameBtn = document.getElementById('endGameBtn');

            // ÿ™ŸáŸäÿ¶ÿ© Web Audio Context
            function initAudio() {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn('Web Audio not supported');
                }
            }

            // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿµŸàÿ™ ÿßŸÑÿ®ÿßÿ≤ ÿπŸÜÿØ ÿßŸÑÿÆÿ∑ÿ£
            function playBuzzer() {
                if (!audioContext) return;

                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);

                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.35);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.35);
            }

            // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿµŸàÿ™ ÿßŸÑÿ¨ŸÑŸäÿ™ÿ± ÿπŸÜÿØ ÿßŸÑÿµÿ≠Ÿäÿ≠
            function playGlitter() {
                if (!audioContext) return;

                const frequencies = [600, 800, 1000, 1200];

                frequencies.forEach((freq, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + index * 0.12);

                    gainNode.gain.setValueAtTime(0, audioContext.currentTime + index * 0.12);
                    gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + index * 0.12 + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.12 + 0.12);

                    oscillator.start(audioContext.currentTime + index * 0.12);
                    oscillator.stop(audioContext.currentTime + index * 0.12 + 0.12);
                });

                // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä ŸÑŸÑÿ¨ŸÑŸäÿ™ÿ±
                createGlitterEffect();
            }

            // ÿ•ŸÜÿ¥ÿßÿ° ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ¨ŸÑŸäÿ™ÿ± ÿßŸÑÿ®ÿµÿ±Ÿä
            function createGlitterEffect() {
                const container = document.querySelector('.container');
                const rect = container.getBoundingClientRect();

                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'glitter-particle';
                    particle.style.left = Math.random() * rect.width + 'px';
                    particle.style.top = rect.height * 0.5 + Math.random() * 100 + 'px';
                    particle.style.backgroundColor = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'][Math.floor(Math.random() * 5)];

                    container.appendChild(particle);

                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 1000);
                }
            }

            // ŸÜÿ∑ŸÇ ÿßŸÑŸÜÿµ ÿ®ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
            function speakText(text, rate = 0.7) {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'ar-SA';
                    utterance.rate = rate;
                    utterance.pitch = 1.1;
                    utterance.volume = 0.8;

                    // ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿµŸàÿ™ ÿπÿ±ÿ®Ÿä ÿ•ŸÜ ŸàŸèÿ¨ÿØ
                    const voices = speechSynthesis.getVoices();
                    const arabicVoice = voices.find((voice) => voice.lang.includes('ar'));
                    if (arabicVoice) {
                        utterance.voice = arabicVoice;
                    }

                    speechSynthesis.speak(utterance);
                }
            }

            // ÿ™ÿ∑ÿ®Ÿäÿπ ÿßŸÑŸÜÿµ ÿßŸÑÿπÿ±ÿ®Ÿä ŸÑŸÑŸÖŸÇÿßÿ±ŸÜÿ©
            function normalizeArabic(text) {
                if (!text) return '';

                return (
                    text
                        .toLowerCase()
                        .trim()
                        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑÿ™ÿ¥ŸÉŸäŸÑ
                        .replace(/[\u064B-\u065F\u0670\u0640]/g, '')
                        // ÿ™Ÿàÿ≠ŸäÿØ ÿßŸÑÿ£ŸÑŸÅ
                        .replace(/[ÿ£ÿ•ÿ¢]/g, 'ÿß')
                        // ÿ™Ÿàÿ≠ŸäÿØ ÿßŸÑŸäÿßÿ°
                        .replace(/Ÿâ/g, 'Ÿä')
                        // ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸáŸÖÿ≤ÿßÿ™ ÿßŸÑÿ≤ÿßÿ¶ÿØÿ©
                        .replace(/ÿ°/g, '')
                        // ÿ•ÿ≤ÿßŸÑÿ© ÿπŸÑÿßŸÖÿßÿ™ ÿßŸÑÿ™ÿ±ŸÇŸäŸÖ ŸàÿßŸÑŸÖÿ≥ÿßŸÅÿßÿ™ ÿßŸÑÿ≤ÿßÿ¶ÿØÿ©
                        .replace(/[.,!?;:]/g, '')
                        .replace(/\s+/g, ' ')
                );
            }

            // ÿßÿÆÿ™Ÿäÿßÿ± ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿπÿ¥Ÿàÿßÿ¶Ÿäÿ© ŸÖŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÑÿπÿ®ÿ©
            function init() {
                initAudio();

                // ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ≥ÿ™ŸÖÿπÿßÿ™ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
                levelButtons.forEach((btn) => {
                    btn.addEventListener('click', () => {
                        levelButtons.forEach((b) => b.classList.remove('active'));
                        btn.classList.add('active');
                        currentLevel = parseInt(btn.dataset.level);
                    });
                });

                startGameBtn.addEventListener('click', startGame);
                checkBtn.addEventListener('click', checkAnswer);
                showWordBtn.addEventListener('click', showWord);
                speakBtn.addEventListener('click', () => {
                    if (currentCard) {
                        if (wordRevealed) {
                            speakText(currentCard.sentence);
                        } else {
                            speakText(currentCard.word);
                        }
                    }
                });
                nextBtn.addEventListener('click', nextCard);
                endGameBtn.addEventListener('click', endGame);

                textInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        checkAnswer();
                    }
                });

                // ÿßÿÆÿ™ÿµÿßÿ±ÿßÿ™ ŸÑŸàÿ≠ÿ© ÿßŸÑŸÖŸÅÿßÿ™Ÿäÿ≠
                document.addEventListener('keydown', (e) => {
                    if (gameArea.style.display === 'none') return;

                    if (e.key === ' ' && e.target !== textInput) {
                        e.preventDefault();
                        speakBtn.click();
                    } else if (e.key >= '1' && e.key <= '9') {
                        const choiceIndex = parseInt(e.key) - 1;
                        const choices = choicesDiv.querySelectorAll('.choice-btn');
                        if (choices[choiceIndex]) {
                            choices[choiceIndex].click();
                        }
                    }
                });

                // ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑÿ£ŸàŸÑ ŸÉÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
                levelButtons[0].classList.add('active');
            }

            // ÿ®ÿØÿ° ÿßŸÑŸÑÿπÿ®ÿ©
            function startGame() {
                if (!audioContext) initAudio();

                const levelData = currentLevel === 1 ? LEVEL1 : currentLevel === 2 ? LEVEL2 : LEVEL3;
                currentCards = shuffleArray(levelData).slice(0, 6);
                currentCardIndex = 0;
                score = 0;

                menuArea.style.display = 'none';
                gameArea.style.display = 'block';

                updateScore();
                renderCard();
            }

            // ÿπÿ±ÿ∂ ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
            function renderCard() {
                currentCard = currentCards[currentCardIndex];
                gamePhase = 'naming';
                attempts = 0;
                wordRevealed = false;

                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿØÿßÿØÿßÿ™
                cardCounter.textContent = `ÿßŸÑÿ®ÿ∑ÿßŸÇÿ© ${currentCardIndex + 1} ŸÖŸÜ 6`;
                const progress = ((currentCardIndex + 1) / 6) * 100;
                progressFill.style.width = progress + '%';

                // ÿπÿ±ÿ∂ ÿßŸÑÿ•ŸäŸÖŸàÿ¨Ÿä ŸàÿßŸÑÿ≥ÿ§ÿßŸÑ
                emojiDisplay.textContent = currentCard.emoji;
                emojiDisplay.setAttribute('aria-label', currentCard.word);
                wordDisplay.textContent = '';
                questionDisplay.textContent = 'ŸÖÿßÿ∞ÿß ÿ™ÿ±Ÿâ ŸÅŸä ÿßŸÑÿµŸàÿ±ÿ©ÿü';

                // ÿ•ÿπÿØÿßÿØ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ•ÿØÿÆÿßŸÑ
                textInput.style.display = 'block';
                textInput.value = '';
                textInput.placeholder = 'ÿßŸÉÿ™ÿ® ÿ•ÿ¨ÿßÿ®ÿ™ŸÉ ŸáŸÜÿß...';
                choicesDiv.innerHTML = '';

                // ÿ•ÿπÿØÿßÿØ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
                checkBtn.style.display = 'inline-block';
                showWordBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
                nextBtn.classList.add('hidden');

                // ÿ•ÿÆŸÅÿßÿ° ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ
                messageDiv.classList.add('hidden');
                sentenceDisplay.classList.add('hidden');

                // ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿ≠ŸÇŸÑ ÿßŸÑÿ•ÿØÿÆÿßŸÑ
                textInput.focus();
            }

            // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑŸÉŸÑŸÖÿ©
            function showWord() {
                if (!wordRevealed) {
                    wordDisplay.textContent = currentCard.word;
                    speakText(currentCard.word);
                    wordRevealed = true;
                    showWordBtn.style.display = 'none';

                    setTimeout(() => {
                        showSentenceAndQuestion();
                    }, 1500);
                }
            }

            // ÿπÿ±ÿ∂ ÿßŸÑÿ¨ŸÖŸÑÿ© Ÿàÿ≥ÿ§ÿßŸÑ ÿßŸÑŸÅŸáŸÖ
            function showSentenceAndQuestion() {
                gamePhase = 'comprehension';

                sentenceDisplay.textContent = currentCard.sentence;
                sentenceDisplay.classList.remove('hidden');

                questionDisplay.textContent = currentCard.question;

                // ÿ•ÿÆŸÅÿßÿ° ÿ≠ŸÇŸÑ ÿßŸÑŸÜÿµ
                textInput.style.display = 'none';

                // ÿπÿ±ÿ∂ ÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿ£ÿ¨Ÿàÿ®ÿ©
                choicesDiv.innerHTML = '';
                currentCard.answers.forEach((answer, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'choice-btn';
                    btn.textContent = answer;
                    btn.addEventListener('click', () => checkMCQAnswer(index));
                    choicesDiv.appendChild(btn);
                });

                speakText(currentCard.sentence);
            }

            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ©
            function checkAnswer() {
                if (gamePhase === 'naming') {
                    checkNameAnswer();
                }
            }

            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿ™ÿ≥ŸÖŸäÿ©
            function checkNameAnswer() {
                const userAnswer = normalizeArabic(textInput.value);
                const correctWord = normalizeArabic(currentCard.word);

                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑŸÉŸÑŸÖÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© ŸàÿßŸÑŸÖÿ±ÿßÿØŸÅÿßÿ™
                const isCorrect = userAnswer === correctWord || currentCard.synonyms.some((synonym) => normalizeArabic(synonym) === userAnswer);

                if (isCorrect) {
                    // ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©
                    attempts++;
                    if (attempts === 1) {
                        score++;
                        updateScore();
                    }

                    showMessage('ÿ£ÿ≠ÿ≥ŸÜÿ™! ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©! üéâ', 'success');
                    playGlitter();

                    wordDisplay.textContent = currentCard.word;
                    wordRevealed = true;
                    speakText(currentCard.word);

                    setTimeout(() => {
                        showSentenceAndQuestion();
                    }, 1200);
                } else {
                    // ÿ•ÿ¨ÿßÿ®ÿ© ÿÆÿßÿ∑ÿ¶ÿ©
                    attempts++;
                    playBuzzer();

                    if (attempts >= 2) {
                        // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑÿ´ÿßŸÜŸäÿ© ŸÅÿßÿ¥ŸÑÿ©
                        showMessage(`ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ŸáŸä: ${currentCard.word}`, 'error');
                        wordDisplay.textContent = currentCard.word;
                        wordRevealed = true;
                        speakText(currentCard.word);

                        setTimeout(() => {
                            showSentenceAndQuestion();
                        }, 2000);
                    } else {
                        // ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ÿßŸÑÿ£ŸàŸÑŸâ ŸÅÿßÿ¥ŸÑÿ© - ÿ•ÿπÿ∑ÿßÿ° ÿ™ŸÑŸÖŸäÿ≠
                        showMessage(`ÿ•ÿ¨ÿßÿ®ÿ© ÿÆÿßÿ∑ÿ¶ÿ©. ÿ™ŸÑŸÖŸäÿ≠: ${currentCard.hint}`, 'hint');
                        textInput.value = '';
                        textInput.focus();
                    }
                }
            }

            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖÿ™ÿπÿØÿØ
            function checkMCQAnswer(selectedIndex) {
                const isCorrect = selectedIndex === 0; // ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ÿØÿßÿ¶ŸÖÿßŸã ÿßŸÑÿ£ŸàŸÑŸâ

                const choices = choicesDiv.querySelectorAll('.choice-btn');
                choices.forEach((btn, index) => {
                    btn.disabled = true;
                    if (index === 0) {
                        btn.classList.add('correct');
                    } else if (index === selectedIndex && !isCorrect) {
                        btn.classList.add('incorrect');
                    }
                });

                if (isCorrect) {
                    showMessage('ŸÖŸÖÿ™ÿßÿ≤! ÿ•ÿ¨ÿßÿ®ÿ© ÿµÿ≠Ÿäÿ≠ÿ©! üåü', 'success');
                    playGlitter();

                    setTimeout(() => {
                        nextCard();
                    }, 1200);
                } else {
                    showMessage('ÿ•ÿ¨ÿßÿ®ÿ© ÿÆÿßÿ∑ÿ¶ÿ©. ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ© ŸÖÿ≠ÿØÿØÿ© ÿ®ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ£ÿÆÿ∂ÿ±.', 'error');
                    playBuzzer();

                    setTimeout(() => {
                        nextCard();
                    }, 2000);
                }
            }

            // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ŸÑŸÑÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©
            function nextCard() {
                currentCardIndex++;

                if (currentCardIndex < currentCards.length) {
                    renderCard();
                } else {
                    endGame();
                }
            }

            // ÿ•ŸÜŸáÿßÿ° ÿßŸÑŸÑÿπÿ®ÿ©
            function endGame() {
                const percentage = Math.round((score / 6) * 100);
                let message = `ÿßŸÜÿ™Ÿáÿ™ ÿßŸÑŸÑÿπÿ®ÿ©! üéä\n\nŸÜŸÇÿßÿ∑ŸÉ: ${score} ŸÖŸÜ 6\nŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÜÿ¨ÿßÿ≠: ${percentage}%\n\n`;

                if (percentage >= 80) {
                    message += 'ÿ£ÿØÿßÿ° ŸÖŸÖÿ™ÿßÿ≤! ÿ£ŸÜÿ™ ÿ®ÿ∑ŸÑ! üèÜ';
                } else if (percentage >= 60) {
                    message += 'ÿ£ÿØÿßÿ° ÿ¨ŸäÿØ! ÿßÿ≥ÿ™ŸÖÿ± ŸÅŸä ÿßŸÑÿ™ÿØÿ±Ÿäÿ®! üëç';
                } else {
                    message += 'ÿ™ÿ≠ÿ™ÿßÿ¨ ŸÑŸÖÿ≤ŸäÿØ ŸÖŸÜ ÿßŸÑÿ™ÿØÿ±Ÿäÿ®. ŸÑÿß ÿ™Ÿäÿ£ÿ≥! üí™';
                }

                alert(message);

                gameArea.style.display = 'none';
                menuArea.style.display = 'block';

                // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑŸÑÿπÿ®ÿ©
                currentCardIndex = 0;
                score = 0;
                currentCards = [];
            }

            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÜŸÇÿßÿ∑
            function updateScore() {
                scoreDisplay.textContent = score;
            }

            // ÿπÿ±ÿ∂ ÿ±ÿ≥ÿßŸÑÿ©
            function showMessage(text, type) {
                messageDiv.textContent = text;
                messageDiv.className = `message ${type}`;
                messageDiv.classList.remove('hidden');
                messageDiv.setAttribute('aria-live', 'polite');
            }

            // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑŸÑÿπÿ®ÿ© ÿπŸÜÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
            document.addEventListener('DOMContentLoaded', init);

            // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ÿµŸàÿßÿ™ ÿπŸÜÿØ ÿ£ŸàŸÑ ÿ™ŸÅÿßÿπŸÑ
            document.addEventListener(
                'click',
                function initAudioOnFirstClick() {
                    if (!audioContext) {
                        initAudio();
                    }
                    document.removeEventListener('click', initAudioOnFirstClick);
                },
                { once: true }
            );
        </script>
    </body>
</html>

<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø©</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Arial', 'Tahoma', sans-serif;
                font-size: 22px;
                line-height: 1.6;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
                direction: rtl;
                color: #333;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
                background: white;
                border-radius: 20px;
                padding: 30px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
            }

            .title {
                font-size: 36px;
                color: #4a5568;
                margin-bottom: 10px;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }

            .subtitle {
                font-size: 20px;
                color: #718096;
                margin-bottom: 20px;
            }

            .level-selector {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-bottom: 30px;
                flex-wrap: wrap;
            }

            .level-btn {
                padding: 15px 30px;
                font-size: 20px;
                border: 3px solid #4299e1;
                background: white;
                color: #4299e1;
                border-radius: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 150px;
            }

            .level-btn:hover,
            .level-btn.active {
                background: #4299e1;
                color: white;
                transform: scale(1.05);
            }

            .start-btn {
                padding: 20px 40px;
                font-size: 24px;
                background: #48bb78;
                color: white;
                border: none;
                border-radius: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .start-btn:hover {
                background: #38a169;
                transform: scale(1.05);
            }

            .game-area {
                display: none;
                text-align: center;
            }

            .progress-bar {
                background: #e2e8f0;
                border-radius: 10px;
                height: 15px;
                margin-bottom: 30px;
                overflow: hidden;
            }

            .progress-fill {
                background: linear-gradient(90deg, #48bb78, #38a169);
                height: 100%;
                transition: width 0.5s ease;
                border-radius: 10px;
            }

            .card-counter {
                font-size: 18px;
                color: #4a5568;
                margin-bottom: 20px;
            }

            .card-display {
                background: #f7fafc;
                border-radius: 20px;
                padding: 40px;
                margin-bottom: 30px;
                border: 3px solid #e2e8f0;
            }

            .emoji-display {
                font-size: 120px;
                margin-bottom: 20px;
                display: block;
            }

            .word-display {
                font-size: 48px;
                color: #2d3748;
                margin-bottom: 20px;
                font-weight: bold;
                min-height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .question {
                font-size: 24px;
                color: #4a5568;
                margin-bottom: 20px;
                font-weight: bold;
            }

            .input-area {
                margin-bottom: 30px;
            }

            .text-input {
                width: 100%;
                max-width: 400px;
                padding: 15px;
                font-size: 20px;
                border: 3px solid #cbd5e0;
                border-radius: 10px;
                text-align: center;
                direction: rtl;
            }

            .text-input:focus {
                outline: none;
                border-color: #4299e1;
            }

            .choices {
                display: flex;
                justify-content: center;
                gap: 20px;
                flex-wrap: wrap;
                margin-top: 20px;
            }

            .choice-btn {
                padding: 15px 25px;
                font-size: 20px;
                border: 3px solid #4299e1;
                background: white;
                color: #4299e1;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 150px;
            }

            .choice-btn:hover {
                background: #4299e1;
                color: white;
            }

            .choice-btn.correct {
                background: #48bb78;
                border-color: #48bb78;
                color: white;
            }

            .choice-btn.incorrect {
                background: #f56565;
                border-color: #f56565;
                color: white;
            }

            .action-buttons {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin: 20px 0;
                flex-wrap: wrap;
            }

            .btn {
                padding: 15px 25px;
                font-size: 18px;
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .btn-primary {
                background: #4299e1;
                color: white;
            }

            .btn-primary:hover {
                background: #3182ce;
            }

            .btn-secondary {
                background: #a0aec0;
                color: white;
            }

            .btn-secondary:hover {
                background: #718096;
            }

            .btn-success {
                background: #48bb78;
                color: white;
            }

            .btn-success:hover {
                background: #38a169;
            }

            .message {
                padding: 20px;
                margin: 20px 0;
                border-radius: 10px;
                font-size: 20px;
                text-align: center;
                font-weight: bold;
            }

            .message.success {
                background: #c6f6d5;
                color: #22543d;
                border: 2px solid #48bb78;
            }

            .message.error {
                background: #fed7d7;
                color: #742a2a;
                border: 2px solid #f56565;
            }

            .message.hint {
                background: #fef5e7;
                color: #744210;
                border: 2px solid #ed8936;
            }

            .score {
                font-size: 20px;
                color: #4a5568;
                margin-bottom: 20px;
            }

            .sentence-display {
                font-size: 24px;
                color: #2d3748;
                margin: 20px 0;
                padding: 20px;
                background: #edf2f7;
                border-radius: 10px;
                border-right: 5px solid #4299e1;
            }

            .hidden {
                display: none !important;
            }

            @media (max-width: 768px) {
                .container {
                    padding: 20px;
                    margin: 10px;
                }

                .title {
                    font-size: 28px;
                }

                .emoji-display {
                    font-size: 80px;
                }

                .word-display {
                    font-size: 32px;
                }

                .level-selector,
                .choices {
                    flex-direction: column;
                    align-items: center;
                }
            }

            /* Accessibility improvements */
            .sr-only {
                position: absolute;
                width: 1px;
                height: 1px;
                padding: 0;
                margin: -1px;
                overflow: hidden;
                clip: rect(0, 0, 0, 0);
                white-space: nowrap;
                border: 0;
            }

            *:focus {
                outline: 3px solid #4299e1;
                outline-offset: 2px;
            }

            .glitter-effect {
                position: fixed;
                pointer-events: none;
                z-index: 1000;
            }

            .glitter-particle {
                position: absolute;
                width: 10px;
                height: 10px;
                background: #ffd700;
                border-radius: 50%;
                animation: glitter 1s ease-out forwards;
            }

            @keyframes glitter {
                0% {
                    transform: translateY(0) scale(1);
                    opacity: 1;
                }
                100% {
                    transform: translateY(-100px) scale(0);
                    opacity: 0;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1 class="title">ğŸ¯ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØ±Ø¯Ø©</h1>
                <p class="subtitle">Ù„Ø¹Ø¨Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ù…ØªØ¹Ø© Ù„ØªØ¹Ù„Ù… Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</p>
            </div>

            <div id="menu" class="menu-area">
                <div class="level-selector">
                    <button class="level-btn" data-level="1">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„<br /><small>Ø£Ø´ÙŠØ§Ø¡ Ù…Ø£Ù„ÙˆÙØ©</small></button>
                    <button class="level-btn" data-level="2">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ<br /><small>Ø£ÙØ¹Ø§Ù„ ÙˆØ£ÙˆØµØ§Ù</small></button>
                    <button class="level-btn" data-level="3">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø«<br /><small>Ø£Ù…Ø§ÙƒÙ† ÙˆÙ…Ø´Ø§Ø¹Ø±</small></button>
                </div>
                <div style="text-align: center">
                    <button id="startGame" class="start-btn">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                </div>
            </div>

            <div id="gameArea" class="game-area">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>

                <div class="card-counter">
                    <span id="cardCounter">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© 1 Ù…Ù† 6</span>
                    <span class="score">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></span>
                </div>

                <div class="card-display">
                    <div id="emojiDisplay" class="emoji-display" role="img"></div>
                    <div id="wordDisplay" class="word-display"></div>
                    <div id="question" class="question"></div>
                </div>

                <div id="inputArea" class="input-area">
                    <input type="text" id="textInput" class="text-input" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§..." aria-label="Ù…ÙƒØ§Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©" />
                    <div id="choices" class="choices"></div>
                </div>

                <div class="action-buttons">
                    <button id="checkBtn" class="btn btn-primary">âœ… ØªØ­Ù‚Ù‚</button>
                    <button id="showWordBtn" class="btn btn-secondary">ğŸ‘ï¸ Ø£Ø¸Ù‡Ø± Ø§Ù„ÙƒÙ„Ù…Ø©</button>
                    <button id="speakBtn" class="btn btn-success">ğŸ”Š Ø§Ù†Ø·Ù‚</button>
                    <button id="nextBtn" class="btn btn-primary hidden">â­ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>

                <div id="message" class="message hidden" role="status" aria-live="polite"></div>
                <div id="sentenceDisplay" class="sentence-display hidden"></div>

                <div style="text-align: center; margin-top: 30px">
                    <button id="endGameBtn" class="btn btn-secondary">ğŸ  Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
                </div>
            </div>
        </div>

        <script>
            // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ù„Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø«Ù„Ø§Ø«Ø©
            const LEVEL1 = [
                { word: 'Ø¯Ø±Ø§Ø¬Ø©', emoji: 'ğŸš²', sentence: 'Ø£Ù†Ø§ Ø£Ø±ÙƒØ¨ Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©.', question: 'Ø£ÙŠÙ† Ù†Ø±ÙƒØ¨ Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© Ø¹Ø§Ø¯Ø©ØŸ', answers: ['ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©', 'ÙÙŠ Ø§Ù„Ø³Ù…Ø§Ø¡'], synonyms: ['Ø¨Ø³ÙƒÙ„ØªÙ‡', 'Ø¨Ø³ÙƒÙ„ÙŠØª'], hint: 'Ù…Ø±ÙƒØ¨Ø© Ù„Ù‡Ø§ Ø¹Ø¬Ù„ØªØ§Ù†.' },
                { word: 'ÙƒØ±Ø©', emoji: 'âš½', sentence: 'Ù†Ù„Ø¹Ø¨ Ø¨Ø§Ù„ÙƒØ±Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ø¹Ø¨.', question: 'Ù…Ø§Ø°Ø§ Ù†ÙØ¹Ù„ Ø¨Ø§Ù„ÙƒØ±Ø©ØŸ', answers: ['Ù†Ù„Ø¹Ø¨', 'Ù†Ø£ÙƒÙ„'], synonyms: ['Ø·Ø§Ø¨Ø©'], hint: 'Ø´ÙŠØ¡ Ù…Ø³ØªØ¯ÙŠØ± Ù†Ù„Ø¹Ø¨ Ø¨Ù‡.' },
                { word: 'ØªÙØ§Ø­Ø©', emoji: 'ğŸ', sentence: 'Ø£Ø­Ø¨ Ø£ÙƒÙ„ Ø§Ù„ØªÙØ§Ø­Ø© Ø§Ù„Ø­Ù…Ø±Ø§Ø¡.', question: 'Ù…Ø§ Ù„ÙˆÙ† Ø§Ù„ØªÙØ§Ø­Ø©ØŸ', answers: ['Ø£Ø­Ù…Ø±', 'Ø£Ø²Ø±Ù‚'], synonyms: ['ØªÙØ§Ø­'], hint: 'ÙØ§ÙƒÙ‡Ø© Ø­Ù…Ø±Ø§Ø¡ Ø£Ùˆ Ø®Ø¶Ø±Ø§Ø¡.' },
                { word: 'Ù‚Ø·Ø©', emoji: 'ğŸ±', sentence: 'Ø§Ù„Ù‚Ø·Ø© ØªØ´Ø±Ø¨ Ø§Ù„Ø­Ù„ÙŠØ¨.', question: 'Ù…Ø§Ø°Ø§ ØªØ´Ø±Ø¨ Ø§Ù„Ù‚Ø·Ø©ØŸ', answers: ['Ø§Ù„Ø­Ù„ÙŠØ¨', 'Ø§Ù„Ø¹ØµÙŠØ±'], synonyms: ['Ù‚Ø·', 'Ù‡Ø±Ø©'], hint: 'Ø­ÙŠÙˆØ§Ù† Ø£Ù„ÙŠÙ ÙŠÙ…ÙˆØ¡.' },
                { word: 'ÙƒØ±Ø³ÙŠ', emoji: 'ğŸª‘', sentence: 'Ø£Ø¬Ù„Ø³ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ±Ø³ÙŠ Ù„Ù„Ø¯Ø±Ø§Ø³Ø©.', question: 'Ù„Ù…Ø§Ø°Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒØ±Ø³ÙŠØŸ', answers: ['Ù„Ù„Ø¬Ù„ÙˆØ³', 'Ù„Ù„Ø£ÙƒÙ„'], synonyms: ['Ù…Ù‚Ø¹Ø¯'], hint: 'Ù†Ø¬Ù„Ø³ Ø¹Ù„ÙŠÙ‡.' },
                { word: 'ÙƒØªØ§Ø¨', emoji: 'ğŸ“–', sentence: 'Ø£Ù‚Ø±Ø£ Ø§Ù„ÙƒØªØ§Ø¨ ÙƒÙ„ ÙŠÙˆÙ….', question: 'Ù…Ø§Ø°Ø§ Ù†ÙØ¹Ù„ Ø¨Ø§Ù„ÙƒØªØ§Ø¨ØŸ', answers: ['Ù†Ù‚Ø±Ø£', 'Ù†Ø±Ø³Ù…'], synonyms: [], hint: 'Ù†Ù‚Ø±Ø£ Ù…Ù†Ù‡ Ø§Ù„Ù‚ØµØµ.' },
                { word: 'Ø´Ø¬Ø±Ø©', emoji: 'ğŸŒ³', sentence: 'Ø§Ù„Ø´Ø¬Ø±Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©.', question: 'Ø£ÙŠÙ† ØªÙˆØ¬Ø¯ Ø§Ù„Ø´Ø¬Ø±Ø©ØŸ', answers: ['ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©', 'ÙÙŠ Ø§Ù„Ø¨Ø­Ø±'], synonyms: [], hint: 'Ù†Ø¨Ø§Øª ÙƒØ¨ÙŠØ± Ù„Ù‡ Ø£ÙˆØ±Ø§Ù‚ Ø®Ø¶Ø±Ø§Ø¡.' },
                { word: 'Ø³ÙŠØ§Ø±Ø©', emoji: 'ğŸš—', sentence: 'Ù†Ø³Ø§ÙØ± Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©.', question: 'ÙƒÙŠÙ Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©ØŸ', answers: ['Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©', 'Ø¨Ø§Ù„Ø·Ø§Ø¦Ø±Ø©'], synonyms: ['Ø¹Ø±Ø¨Ø©'], hint: 'Ù…Ø±ÙƒØ¨Ø© Ù„Ù‡Ø§ Ø£Ø±Ø¨Ø¹ Ø¹Ø¬Ù„Ø§Øª.' },
                { word: 'ÙƒÙˆØ¨', emoji: 'ğŸ¥¤', sentence: 'Ø£Ø´Ø±Ø¨ Ø§Ù„Ù…Ø§Ø¡ Ù…Ù† Ø§Ù„ÙƒÙˆØ¨.', question: 'Ù…Ø§Ø°Ø§ Ù†Ø´Ø±Ø¨ Ù…Ù† Ø§Ù„ÙƒÙˆØ¨ØŸ', answers: ['Ø§Ù„Ù…Ø§Ø¡', 'Ø§Ù„Ø®Ø¨Ø²'], synonyms: ['ÙƒØ£Ø³'], hint: 'Ù†Ø´Ø±Ø¨ Ù…Ù†Ù‡ Ø§Ù„Ù…Ø§Ø¡.' },
                { word: 'Ø­Ø°Ø§Ø¡', emoji: 'ğŸ‘Ÿ', sentence: 'Ø£Ù„Ø¨Ø³ Ø§Ù„Ø­Ø°Ø§Ø¡ Ù‚Ø¨Ù„ Ø§Ù„Ø®Ø±ÙˆØ¬.', question: 'Ù…ØªÙ‰ Ù†Ù„Ø¨Ø³ Ø§Ù„Ø­Ø°Ø§Ø¡ØŸ', answers: ['Ù‚Ø¨Ù„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'Ø¹Ù†Ø¯ Ø§Ù„Ù†ÙˆÙ…'], synonyms: ['Ø¬Ø²Ù…Ø©'], hint: 'Ù†Ù„Ø¨Ø³Ù‡ ÙÙŠ Ù‚Ø¯Ù…Ù†Ø§.' }
            ];

            const LEVEL2 = [
                { word: 'ÙŠØ±ÙƒØ¶', emoji: 'ğŸƒâ€â™‚ï¸', sentence: 'Ø§Ù„ÙˆÙ„Ø¯ ÙŠØ±ÙƒØ¶ Ø¨Ø³Ø±Ø¹Ø©.', question: 'Ù‡Ù„ ÙŠØ±ÙƒØ¶ Ø§Ù„ÙˆÙ„Ø¯ Ø£Ù… ÙŠØ¬Ù„Ø³ØŸ', answers: ['ÙŠØ±ÙƒØ¶', 'ÙŠØ¬Ù„Ø³'], synonyms: ['ÙŠØ¬Ø±ÙŠ'], hint: 'ÙŠØªØ­Ø±Ùƒ Ø¨Ø³Ø±Ø¹Ø© Ø¹Ù„Ù‰ Ù‚Ø¯Ù…ÙŠÙ‡.' },
                { word: 'ÙŠØ£ÙƒÙ„', emoji: 'ğŸ½ï¸', sentence: 'Ø£Ù†Ø§ Ø¢ÙƒÙ„ ØªÙØ§Ø­Ø©.', question: 'Ù…Ø§Ø°Ø§ Ø¢ÙƒÙ„ØŸ', answers: ['ØªÙØ§Ø­Ø©', 'ÙƒØªØ§Ø¨'], synonyms: [], hint: 'Ù†Ø¶Ø¹ Ø§Ù„Ø·Ø¹Ø§Ù… ÙÙŠ Ø§Ù„ÙÙ….' },
                { word: 'ÙŠÙØªØ­', emoji: 'ğŸ”“', sentence: 'Ù†ÙØªØ­ Ø§Ù„Ø¨Ø§Ø¨.', question: 'Ù…Ø§Ø°Ø§ Ù†ÙØªØ­ØŸ', answers: ['Ø§Ù„Ø¨Ø§Ø¨', 'Ø§Ù„Ø³Ù…Ø§Ø¡'], synonyms: [], hint: 'Ø¹ÙƒØ³ ÙŠÙØºÙ„Ù‚.' },
                { word: 'ÙƒØ¨ÙŠØ±', emoji: 'ğŸ“', sentence: 'Ù‡Ø°Ø§ ØµÙ†Ø¯ÙˆÙ‚ ÙƒØ¨ÙŠØ±.', question: 'Ù‡Ù„ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ ÙƒØ¨ÙŠØ± Ø£Ù… ØµØºÙŠØ±ØŸ', answers: ['ÙƒØ¨ÙŠØ±', 'ØµØºÙŠØ±'], synonyms: ['Ø¶Ø®Ù…'], hint: 'Ø¹ÙƒØ³ ØµØºÙŠØ±.' },
                { word: 'Ø³Ø±ÙŠØ¹', emoji: 'ğŸ‡', sentence: 'Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø³Ø±ÙŠØ¹Ø©.', question: 'Ù‡Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¨Ø·ÙŠØ¦Ø©ØŸ', answers: ['Ù„Ø§', 'Ù†Ø¹Ù…'], synonyms: [], hint: 'Ø¹ÙƒØ³ Ø¨Ø·ÙŠØ¡.' },
                { word: 'ÙŠØ¶Ø­Ùƒ', emoji: 'ğŸ˜‚', sentence: 'Ø§Ù„Ø·ÙÙ„ ÙŠØ¶Ø­Ùƒ Ù…Ù† ÙØ±Ø­ØªÙ‡.', question: 'Ù„Ù…Ø§Ø°Ø§ ÙŠØ¶Ø­Ùƒ Ø§Ù„Ø·ÙÙ„ØŸ', answers: ['Ù…Ù† ÙØ±Ø­ØªÙ‡', 'Ù…Ù† Ø­Ø²Ù†Ù‡'], synonyms: [], hint: 'Ù†ÙØ¹Ù„Ù‡ Ø¹Ù†Ø¯Ù…Ø§ Ù†ÙƒÙˆÙ† Ø³Ø¹Ø¯Ø§Ø¡.' },
                { word: 'ÙŠØ±Ø³Ù…', emoji: 'ğŸ¨', sentence: 'Ø§Ù„Ø¨Ù†Øª ØªØ±Ø³Ù… ØµÙˆØ±Ø© Ø¬Ù…ÙŠÙ„Ø©.', question: 'Ù…Ø§Ø°Ø§ ØªØ±Ø³Ù… Ø§Ù„Ø¨Ù†ØªØŸ', answers: ['ØµÙˆØ±Ø©', 'ÙƒØªØ§Ø¨'], synonyms: [], hint: 'Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚Ù„Ù… ÙˆØ§Ù„ÙˆØ±Ù‚.' },
                { word: 'Ø£Ø­Ù…Ø±', emoji: 'ğŸ”´', sentence: 'Ù‡Ø°Ø§ ØªÙØ§Ø­ Ø£Ø­Ù…Ø±.', question: 'Ù…Ø§ Ù„ÙˆÙ† Ø§Ù„ØªÙØ§Ø­ØŸ', answers: ['Ø£Ø­Ù…Ø±', 'Ø£Ø³ÙˆØ¯'], synonyms: [], hint: 'Ù„ÙˆÙ† Ø§Ù„Ù†Ø§Ø±.' },
                { word: 'ÙŠØºÙ†ÙŠ', emoji: 'ğŸµ', sentence: 'Ø§Ù„Ø·Ø§Ø¦Ø± ÙŠØºÙ†ÙŠ ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­.', question: 'Ù…ØªÙ‰ ÙŠØºÙ†ÙŠ Ø§Ù„Ø·Ø§Ø¦Ø±ØŸ', answers: ['ÙÙŠ Ø§Ù„ØµØ¨Ø§Ø­', 'ÙÙŠ Ø§Ù„Ù„ÙŠÙ„'], synonyms: [], hint: 'ÙŠØµØ¯Ø± Ø£ØµÙˆØ§ØªØ§Ù‹ Ø¬Ù…ÙŠÙ„Ø©.' },
                { word: 'Ù†Ø¸ÙŠÙ', emoji: 'ğŸ§¼', sentence: 'Ø§Ù„Ø«ÙˆØ¨ Ù†Ø¸ÙŠÙ ÙˆØ¬Ù…ÙŠÙ„.', question: 'ÙƒÙŠÙ Ø§Ù„Ø«ÙˆØ¨ØŸ', answers: ['Ù†Ø¸ÙŠÙ', 'Ù…ØªØ³Ø®'], synonyms: ['Ø·Ø§Ù‡Ø±'], hint: 'Ø¹ÙƒØ³ Ù…ØªØ³Ø®.' }
            ];

            const LEVEL3 = [
                { word: 'Ø­Ø¯ÙŠÙ‚Ø©', emoji: 'ğŸŒ¼', sentence: 'Ù†Ù„Ø¹Ø¨ ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©.', question: 'Ø£ÙŠÙ† Ù†Ù„Ø¹Ø¨ØŸ', answers: ['ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©', 'ÙÙŠ Ø§Ù„Ø¨ÙŠØª'], synonyms: ['Ø¨Ø³ØªØ§Ù†'], hint: 'Ù…ÙƒØ§Ù† ÙÙŠÙ‡ Ø£Ø´Ø¬Ø§Ø± ÙˆØ£Ø²Ù‡Ø§Ø±.' },
                { word: 'Ø´Ø§Ø·Ø¦', emoji: 'ğŸ–ï¸', sentence: 'Ù†Ø³Ø¨Ø­ ÙÙŠ Ø§Ù„Ø¨Ø­Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø·Ø¦.', question: 'Ø£ÙŠÙ† Ù†Ø³Ø¨Ø­ ÙÙŠ Ø§Ù„Ø¨Ø­Ø±ØŸ', answers: ['Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø·Ø¦', 'ÙÙŠ Ø§Ù„ØµØ­Ø±Ø§Ø¡'], synonyms: [], hint: 'Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ‚Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø± Ø¨Ø§Ù„ÙŠØ§Ø¨Ø³Ø©.' },
                { word: 'Ù…ÙƒØªØ¨Ø©', emoji: 'ğŸ“š', sentence: 'Ø£Ù‚Ø±Ø£ Ø§Ù„ÙƒØªØ¨ ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø©.', question: 'Ø£ÙŠÙ† Ø£Ù‚Ø±Ø£ Ø§Ù„ÙƒØªØ¨ØŸ', answers: ['ÙÙŠ Ø§Ù„Ù…ÙƒØªØ¨Ø©', 'ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚'], synonyms: [], hint: 'Ù…ÙƒØ§Ù† ÙÙŠÙ‡ ÙƒØªØ¨ ÙƒØ«ÙŠØ±Ø©.' },
                { word: 'Ù…Ø³ØªØ´ÙÙ‰', emoji: 'ğŸ¥', sentence: 'Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±Ø¶.', question: 'Ù…ØªÙ‰ Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ØŸ', answers: ['Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±Ø¶', 'Ø¹Ù†Ø¯ Ø§Ù„ÙØ±Ø­'], synonyms: [], hint: 'Ù…ÙƒØ§Ù† Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ø±Ø¶Ù‰.' },
                { word: 'Ø³Ø¹Ø§Ø¯Ø©', emoji: 'ğŸ˜Š', sentence: 'Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø³Ø¹Ø§Ø¯Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù„Ø¹Ø¨.', question: 'Ù…ØªÙ‰ ØªØ´Ø¹Ø± Ø¨Ø§Ù„Ø³Ø¹Ø§Ø¯Ø©ØŸ', answers: ['Ø¹Ù†Ø¯ Ø§Ù„Ù„Ø¹Ø¨', 'Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø²Ù†'], synonyms: ['ÙØ±Ø­'], hint: 'Ø´Ø¹ÙˆØ± Ø¬Ù…ÙŠÙ„ Ø¹ÙƒØ³ Ø§Ù„Ø­Ø²Ù†.' },
                { word: 'Ø®ÙˆÙ', emoji: 'ğŸ˜¨', sentence: 'Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ø¸Ù„Ø§Ù….', question: 'Ù…Ù… Ø£Ø´Ø¹Ø± Ø¨Ø§Ù„Ø®ÙˆÙØŸ', answers: ['Ù…Ù† Ø§Ù„Ø¸Ù„Ø§Ù…', 'Ù…Ù† Ø§Ù„Ù†ÙˆØ±'], synonyms: [], hint: 'Ø´Ø¹ÙˆØ± Ø¹Ù†Ø¯Ù…Ø§ Ù†Ø®Ø§Ù.' },
                { word: 'Ø¨Ø±ÙƒØ§Ù†', emoji: 'ğŸŒ‹', sentence: 'Ø§Ù„Ø¨Ø±ÙƒØ§Ù† Ø¬Ø¨Ù„ ÙŠØ®Ø±Ø¬ Ù…Ù†Ù‡ Ù†Ø§Ø±.', question: 'Ù‡Ù„ Ø§Ù„Ø¨Ø±ÙƒØ§Ù† Ù…ÙƒØ§Ù† Ø¨Ø§Ø±Ø¯ØŸ', answers: ['Ù„Ø§', 'Ù†Ø¹Ù…'], synonyms: [], hint: 'Ø¬Ø¨Ù„ ÙŠØ®Ø±Ø¬ Ù…Ù†Ù‡ Ù†Ø§Ø± ÙˆØ¯Ø®Ø§Ù†.' },
                { word: 'ØµØ­Ø±Ø§Ø¡', emoji: 'ğŸœï¸', sentence: 'Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ù…ÙƒØ§Ù† ÙÙŠÙ‡ Ø±Ù…Ø§Ù„ ÙƒØ«ÙŠØ±Ø©.', question: 'Ù…Ø§Ø°Ø§ ÙŠÙˆØ¬Ø¯ ÙÙŠ Ø§Ù„ØµØ­Ø±Ø§Ø¡ØŸ', answers: ['Ø±Ù…Ø§Ù„', 'Ø«Ù„Ø¬'], synonyms: [], hint: 'Ù…ÙƒØ§Ù† Ø¬Ø§Ù ÙÙŠÙ‡ Ø±Ù…Ø§Ù„.' },
                { word: 'Ø¬Ø³Ø±', emoji: 'ğŸŒ‰', sentence: 'Ù†Ø¹Ø¨Ø± Ø§Ù„Ù†Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø³Ø±.', question: 'ÙƒÙŠÙ Ù†Ø¹Ø¨Ø± Ø§Ù„Ù†Ù‡Ø±ØŸ', answers: ['Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø³Ø±', 'ØªØ­Øª Ø§Ù„Ù…Ø§Ø¡'], synonyms: [], hint: 'Ø·Ø±ÙŠÙ‚ ÙŠØ¹Ù„Ùˆ Ø§Ù„Ù…Ø§Ø¡.' },
                { word: 'Ù‚Ù„Ø¹Ø©', emoji: 'ğŸ°', sentence: 'Ø§Ù„Ù‚Ù„Ø¹Ø© Ø¨Ù†Ø§Ø¡ Ù‚Ø¯ÙŠÙ… ÙˆÙ‚ÙˆÙŠ.', question: 'ÙƒÙŠÙ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙÙŠ Ø§Ù„Ù‚Ù„Ø¹Ø©ØŸ', answers: ['Ù‚Ø¯ÙŠÙ… ÙˆÙ‚ÙˆÙŠ', 'Ø¬Ø¯ÙŠØ¯ ÙˆØ¶Ø¹ÙŠÙ'], synonyms: ['Ø­ØµÙ†'], hint: 'Ø¨Ù†Ø§Ø¡ Ù‚Ø¯ÙŠÙ… Ù„Ù„Ø­Ù…Ø§ÙŠØ©.' }
            ];

            // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
            let currentLevel = 1;
            let currentCards = [];
            let currentCardIndex = 0;
            let score = 0;
            let attempts = 0;
            let audioContext;
            let gamePhase = 'naming'; // 'naming' Ø£Ùˆ 'comprehension'
            let currentCard = null;
            let wordRevealed = false;

            // Ø¹Ù†Ø§ØµØ± DOM
            const menuArea = document.getElementById('menu');
            const gameArea = document.getElementById('gameArea');
            const levelButtons = document.querySelectorAll('.level-btn');
            const startGameBtn = document.getElementById('startGame');
            const cardCounter = document.getElementById('cardCounter');
            const scoreDisplay = document.getElementById('score');
            const progressFill = document.getElementById('progressFill');
            const emojiDisplay = document.getElementById('emojiDisplay');
            const wordDisplay = document.getElementById('wordDisplay');
            const questionDisplay = document.getElementById('question');
            const inputArea = document.getElementById('inputArea');
            const textInput = document.getElementById('textInput');
            const choicesDiv = document.getElementById('choices');
            const checkBtn = document.getElementById('checkBtn');
            const showWordBtn = document.getElementById('showWordBtn');
            const speakBtn = document.getElementById('speakBtn');
            const nextBtn = document.getElementById('nextBtn');
            const messageDiv = document.getElementById('message');
            const sentenceDisplay = document.getElementById('sentenceDisplay');
            const endGameBtn = document.getElementById('endGameBtn');

            // ØªÙ‡ÙŠØ¦Ø© Web Audio Context
            function initAudio() {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn('Web Audio not supported');
                }
            }

            // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø¨Ø§Ø² Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£
            function playBuzzer() {
                if (!audioContext) return;

                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);

                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);

                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.3, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.35);

                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.35);
            }

            // ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ø¬Ù„ÙŠØªØ± Ø¹Ù†Ø¯ Ø§Ù„ØµØ­ÙŠØ­
            function playGlitter() {
                if (!audioContext) return;

                const frequencies = [600, 800, 1000, 1200];

                frequencies.forEach((freq, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime + index * 0.12);

                    gainNode.gain.setValueAtTime(0, audioContext.currentTime + index * 0.12);
                    gainNode.gain.linearRampToValueAtTime(0.2, audioContext.currentTime + index * 0.12 + 0.01);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.12 + 0.12);

                    oscillator.start(audioContext.currentTime + index * 0.12);
                    oscillator.stop(audioContext.currentTime + index * 0.12 + 0.12);
                });

                // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ù„Ù„Ø¬Ù„ÙŠØªØ±
                createGlitterEffect();
            }

            // Ø¥Ù†Ø´Ø§Ø¡ ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ù„ÙŠØªØ± Ø§Ù„Ø¨ØµØ±ÙŠ
            function createGlitterEffect() {
                const container = document.querySelector('.container');
                const rect = container.getBoundingClientRect();

                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'glitter-particle';
                    particle.style.left = Math.random() * rect.width + 'px';
                    particle.style.top = rect.height * 0.5 + Math.random() * 100 + 'px';
                    particle.style.backgroundColor = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'][Math.floor(Math.random() * 5)];

                    container.appendChild(particle);

                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 1000);
                }
            }

            // Ù†Ø·Ù‚ Ø§Ù„Ù†Øµ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
            function speakText(text, rate = 0.7) {
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'ar-SA';
                    utterance.rate = rate;
                    utterance.pitch = 1.1;
                    utterance.volume = 0.8;

                    // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙˆØª Ø¹Ø±Ø¨ÙŠ Ø¥Ù† ÙˆÙØ¬Ø¯
                    const voices = speechSynthesis.getVoices();
                    const arabicVoice = voices.find((voice) => voice.lang.includes('ar'));
                    if (arabicVoice) {
                        utterance.voice = arabicVoice;
                    }

                    speechSynthesis.speak(utterance);
                }
            }

            // ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
            function normalizeArabic(text) {
                if (!text) return '';

                return (
                    text
                        .toLowerCase()
                        .trim()
                        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„
                        .replace(/[\u064B-\u065F\u0670\u0640]/g, '')
                        // ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø£Ù„Ù
                        .replace(/[Ø£Ø¥Ø¢]/g, 'Ø§')
                        // ØªÙˆØ­ÙŠØ¯ Ø§Ù„ÙŠØ§Ø¡
                        .replace(/Ù‰/g, 'ÙŠ')
                        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ù…Ø²Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©
                        .replace(/Ø¡/g, '')
                        // Ø¥Ø²Ø§Ù„Ø© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ±Ù‚ÙŠÙ… ÙˆØ§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©
                        .replace(/[.,!?;:]/g, '')
                        .replace(/\s+/g, ' ')
                );
            }

            // Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            function shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
            function init() {
                initAudio();

                // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
                levelButtons.forEach((btn) => {
                    btn.addEventListener('click', () => {
                        levelButtons.forEach((b) => b.classList.remove('active'));
                        btn.classList.add('active');
                        currentLevel = parseInt(btn.dataset.level);
                    });
                });

                startGameBtn.addEventListener('click', startGame);
                checkBtn.addEventListener('click', checkAnswer);
                showWordBtn.addEventListener('click', showWord);
                speakBtn.addEventListener('click', () => {
                    if (currentCard) {
                        if (wordRevealed) {
                            speakText(currentCard.sentence);
                        } else {
                            speakText(currentCard.word);
                        }
                    }
                });
                nextBtn.addEventListener('click', nextCard);
                endGameBtn.addEventListener('click', endGame);

                textInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        checkAnswer();
                    }
                });

                // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
                document.addEventListener('keydown', (e) => {
                    if (gameArea.style.display === 'none') return;

                    if (e.key === ' ' && e.target !== textInput) {
                        e.preventDefault();
                        speakBtn.click();
                    } else if (e.key >= '1' && e.key <= '9') {
                        const choiceIndex = parseInt(e.key) - 1;
                        const choices = choicesDiv.querySelectorAll('.choice-btn');
                        if (choices[choiceIndex]) {
                            choices[choiceIndex].click();
                        }
                    }
                });

                // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„ ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ
                levelButtons[0].classList.add('active');
            }

            // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function startGame() {
                if (!audioContext) initAudio();

                const levelData = currentLevel === 1 ? LEVEL1 : currentLevel === 2 ? LEVEL2 : LEVEL3;
                currentCards = shuffleArray(levelData).slice(0, 6);
                currentCardIndex = 0;
                score = 0;

                menuArea.style.display = 'none';
                gameArea.style.display = 'block';

                updateScore();
                renderCard();
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            function renderCard() {
                currentCard = currentCards[currentCardIndex];
                gamePhase = 'naming';
                attempts = 0;
                wordRevealed = false;

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
                cardCounter.textContent = `Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ${currentCardIndex + 1} Ù…Ù† 6`;
                const progress = ((currentCardIndex + 1) / 6) * 100;
                progressFill.style.width = progress + '%';

                // Ø¹Ø±Ø¶ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙˆØ§Ù„Ø³Ø¤Ø§Ù„
                emojiDisplay.textContent = currentCard.emoji;
                emojiDisplay.setAttribute('aria-label', currentCard.word);
                wordDisplay.textContent = '';
                questionDisplay.textContent = 'Ù…Ø§Ø°Ø§ ØªØ±Ù‰ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©ØŸ';

                // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                textInput.style.display = 'block';
                textInput.value = '';
                textInput.placeholder = 'Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§...';
                choicesDiv.innerHTML = '';

                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                checkBtn.style.display = 'inline-block';
                showWordBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
                nextBtn.classList.add('hidden');

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                messageDiv.classList.add('hidden');
                sentenceDisplay.classList.add('hidden');

                // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
                textInput.focus();
            }

            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒÙ„Ù…Ø©
            function showWord() {
                if (!wordRevealed) {
                    wordDisplay.textContent = currentCard.word;
                    speakText(currentCard.word);
                    wordRevealed = true;
                    showWordBtn.style.display = 'none';

                    setTimeout(() => {
                        showSentenceAndQuestion();
                    }, 1500);
                }
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ù…Ù„Ø© ÙˆØ³Ø¤Ø§Ù„ Ø§Ù„ÙÙ‡Ù…
            function showSentenceAndQuestion() {
                gamePhase = 'comprehension';

                sentenceDisplay.textContent = currentCard.sentence;
                sentenceDisplay.classList.remove('hidden');

                questionDisplay.textContent = currentCard.question;

                // Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚Ù„ Ø§Ù„Ù†Øµ
                textInput.style.display = 'none';

                // Ø¹Ø±Ø¶ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø¬ÙˆØ¨Ø©
                choicesDiv.innerHTML = '';
                currentCard.answers.forEach((answer, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'choice-btn';
                    btn.textContent = answer;
                    btn.addEventListener('click', () => checkMCQAnswer(index));
                    choicesDiv.appendChild(btn);
                });

                speakText(currentCard.sentence);
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            function checkAnswer() {
                if (gamePhase === 'naming') {
                    checkNameAnswer();
                }
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØªØ³Ù…ÙŠØ©
            function checkNameAnswer() {
                const userAnswer = normalizeArabic(textInput.value);
                const correctWord = normalizeArabic(currentCard.word);

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ù…Ø±Ø§Ø¯ÙØ§Øª
                const isCorrect = userAnswer === correctWord || currentCard.synonyms.some((synonym) => normalizeArabic(synonym) === userAnswer);

                if (isCorrect) {
                    // Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
                    attempts++;
                    if (attempts === 1) {
                        score++;
                        updateScore();
                    }

                    showMessage('Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰', 'success');
                    playGlitter();

                    wordDisplay.textContent = currentCard.word;
                    wordRevealed = true;
                    speakText(currentCard.word);

                    setTimeout(() => {
                        showSentenceAndQuestion();
                    }, 1200);
                } else {
                    // Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©
                    attempts++;
                    playBuzzer();

                    if (attempts >= 2) {
                        // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© ÙØ§Ø´Ù„Ø©
                        showMessage(`Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: ${currentCard.word}`, 'error');
                        wordDisplay.textContent = currentCard.word;
                        wordRevealed = true;
                        speakText(currentCard.word);

                        setTimeout(() => {
                            showSentenceAndQuestion();
                        }, 2000);
                    } else {
                        // Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙØ§Ø´Ù„Ø© - Ø¥Ø¹Ø·Ø§Ø¡ ØªÙ„Ù…ÙŠØ­
                        showMessage(`Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. ØªÙ„Ù…ÙŠØ­: ${currentCard.hint}`, 'hint');
                        textInput.value = '';
                        textInput.focus();
                    }
                }
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯
            function checkMCQAnswer(selectedIndex) {
                const isCorrect = selectedIndex === 0; // Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø§Ù„Ø£ÙˆÙ„Ù‰

                const choices = choicesDiv.querySelectorAll('.choice-btn');
                choices.forEach((btn, index) => {
                    btn.disabled = true;
                    if (index === 0) {
                        btn.classList.add('correct');
                    } else if (index === selectedIndex && !isCorrect) {
                        btn.classList.add('incorrect');
                    }
                });

                if (isCorrect) {
                    showMessage('Ù…Ù…ØªØ§Ø²! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸŒŸ', 'success');
                    playGlitter();

                    setTimeout(() => {
                        nextCard();
                    }, 1200);
                } else {
                    showMessage('Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ø­Ø¯Ø¯Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø®Ø¶Ø±.', 'error');
                    playBuzzer();

                    setTimeout(() => {
                        nextCard();
                    }, 2000);
                }
            }

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
            function nextCard() {
                currentCardIndex++;

                if (currentCardIndex < currentCards.length) {
                    renderCard();
                } else {
                    endGame();
                }
            }

            // Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function endGame() {
                const percentage = Math.round((score / 6) * 100);
                let message = `Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! ğŸŠ\n\nÙ†Ù‚Ø§Ø·Ùƒ: ${score} Ù…Ù† 6\nÙ†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: ${percentage}%\n\n`;

                if (percentage >= 80) {
                    message += 'Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! Ø£Ù†Øª Ø¨Ø·Ù„! ğŸ†';
                } else if (percentage >= 60) {
                    message += 'Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªØ¯Ø±ÙŠØ¨! ğŸ‘';
                } else {
                    message += 'ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨. Ù„Ø§ ØªÙŠØ£Ø³! ğŸ’ª';
                }

                alert(message);

                gameArea.style.display = 'none';
                menuArea.style.display = 'block';

                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
                currentCardIndex = 0;
                score = 0;
                currentCards = [];
            }

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø§Ø·
            function updateScore() {
                scoreDisplay.textContent = score;
            }

            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
            function showMessage(text, type) {
                messageDiv.textContent = text;
                messageDiv.className = `message ${type}`;
                messageDiv.classList.remove('hidden');
                messageDiv.setAttribute('aria-live', 'polite');
            }

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            document.addEventListener('DOMContentLoaded', init);

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªÙØ§Ø¹Ù„
            document.addEventListener(
                'click',
                function initAudioOnFirstClick() {
                    if (!audioContext) {
                        initAudio();
                    }
                    document.removeEventListener('click', initAudioOnFirstClick);
                },
                { once: true }
            );
        </script>
    </body>
</html>

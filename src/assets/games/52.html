<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ù…Ø¹Ù†Ù‰ Ù…Ù† Ø§Ù„Ø³ÙŠØ§Ù‚</title>
        <style>
            :root {
                --purple: #6a00b6;
                --purple-weak: #8e4bd6;
                --yellow: #ffd93d;
                --bg: #161024;
                --card: #22173a;
                --text: #fff;
                --success: #4caf50;
                --error: #f44336;
            }

            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, var(--bg) 0%, var(--purple) 100%);
                color: var(--text);
                min-height: 100vh;
                font-size: 20px;
                line-height: 1.6;
                padding: 20px;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
            }

            .header {
                text-align: center;
                margin-bottom: 30px;
            }

            .header h1 {
                font-size: 2.5em;
                color: var(--yellow);
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                margin-bottom: 15px;
            }

            .header p {
                font-size: 1.2em;
                color: var(--purple-weak);
            }

            .card {
                background: var(--card);
                border-radius: 15px;
                padding: 30px;
                margin: 20px 0;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
                border: 2px solid var(--purple-weak);
            }

            .level-selection {
                text-align: center;
            }

            .level-btn {
                background: var(--purple);
                color: white;
                border: none;
                border-radius: 12px;
                padding: 15px 30px;
                margin: 10px;
                font-size: 1.1em;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(106, 0, 182, 0.3);
            }

            .level-btn:hover {
                background: var(--purple-weak);
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(106, 0, 182, 0.4);
            }

            .start-btn {
                background: var(--yellow);
                color: #333;
                border: none;
                border-radius: 12px;
                padding: 20px 40px;
                font-size: 1.3em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                margin-top: 20px;
            }

            .start-btn:hover {
                background: #ffed4e;
                transform: scale(1.05);
            }

            .game-area {
                display: none;
            }

            .progress-bar {
                background: rgba(255, 255, 255, 0.2);
                border-radius: 10px;
                height: 20px;
                margin-bottom: 20px;
                overflow: hidden;
            }

            .progress-fill {
                background: linear-gradient(90deg, var(--purple), var(--yellow));
                height: 100%;
                border-radius: 10px;
                transition: width 0.5s ease;
            }

            .passage-area {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 12px;
                padding: 25px;
                margin: 20px 0;
                font-size: 1.3em;
                line-height: 1.8;
                border-right: 4px solid var(--yellow);
            }

            .highlight-word {
                background: var(--yellow);
                color: #333;
                padding: 2px 6px;
                border-radius: 4px;
                font-weight: bold;
            }

            .highlight-cue {
                background: var(--purple-weak);
                color: white;
                padding: 1px 3px;
                border-radius: 3px;
            }

            .options-area {
                display: grid;
                gap: 15px;
                margin: 25px 0;
            }

            .option-btn {
                background: rgba(255, 255, 255, 0.1);
                color: var(--text);
                border: 2px solid var(--purple-weak);
                border-radius: 12px;
                padding: 20px;
                font-size: 1.2em;
                cursor: pointer;
                transition: all 0.3s ease;
                text-align: center;
            }

            .option-btn:hover {
                background: var(--purple-weak);
                transform: scale(1.02);
            }

            .option-btn.selected {
                background: var(--yellow);
                color: #333;
                border-color: var(--yellow);
            }

            .controls {
                display: flex;
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
                margin: 20px 0;
            }

            .control-btn {
                background: rgba(255, 255, 255, 0.1);
                color: var(--text);
                border: 1px solid var(--purple-weak);
                border-radius: 8px;
                padding: 12px 20px;
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 1em;
            }

            .control-btn:hover {
                background: var(--purple-weak);
            }

            .check-btn {
                background: var(--success);
                color: white;
                font-weight: bold;
            }

            .evidence-input {
                background: rgba(255, 255, 255, 0.1);
                color: var(--text);
                border: 2px solid var(--purple-weak);
                border-radius: 8px;
                padding: 15px;
                font-size: 1.1em;
                width: 100%;
                margin: 15px 0;
            }

            .evidence-input::placeholder {
                color: rgba(255, 255, 255, 0.6);
            }

            .feedback {
                margin: 20px 0;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                font-size: 1.2em;
                min-height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .feedback.success {
                background: rgba(76, 175, 80, 0.2);
                border: 2px solid var(--success);
            }

            .feedback.error {
                background: rgba(244, 67, 54, 0.2);
                border: 2px solid var(--error);
            }

            .stats {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin: 20px 0;
                font-size: 1.1em;
            }

            .score {
                background: var(--purple);
                padding: 10px 20px;
                border-radius: 20px;
            }

            .footer {
                text-align: center;
                margin-top: 50px;
                padding: 20px;
                color: var(--purple-weak);
                font-style: italic;
            }

            .glitter {
                animation: glitterPulse 1.2s ease-in-out;
            }

            @keyframes glitterPulse {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.05);
                    filter: brightness(1.2);
                }
            }

            .focus-mode body {
                line-height: 2;
                letter-spacing: 1px;
            }

            .focus-btn {
                position: fixed;
                top: 20px;
                left: 20px;
                background: var(--yellow);
                color: #333;
                border: none;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                cursor: pointer;
                font-size: 1.5em;
            }

            @media (max-width: 768px) {
                body {
                    font-size: 18px;
                    padding: 10px;
                }

                .controls {
                    flex-direction: column;
                }

                .control-btn {
                    width: 100%;
                }
            }

            .hidden {
                display: none !important;
            }
        </style>
    </head>
    <body>
        <button class="focus-btn" onclick="toggleFocusMode()" title="ÙˆØ¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ²">ğŸ‘ï¸</button>

        <div class="container">
            <div class="header">
                <h1>ğŸ” Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ù…Ø¹Ù†Ù‰ Ù…Ù† Ø§Ù„Ø³ÙŠØ§Ù‚</h1>
                <p>ØªØ¹Ù„Ù… Ù…Ø¹Ø§Ù†ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù…Ù† Ø®Ù„Ø§Ù„ ÙÙ‡Ù… Ø§Ù„Ù†Øµ</p>
            </div>

            <div id="level-selection" class="card level-selection">
                <h2>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªÙˆÙ‰:</h2>
                <div>
                    <button class="level-btn" data-level="1">
                        ğŸŒŸ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„ - Ø³Ù‡Ù„
                        <br /><small>Ù‚Ø±Ø§Ø¦Ù† ÙˆØ§Ø¶Ø­Ø©</small>
                    </button>
                    <button class="level-btn" data-level="2">
                        â­ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ù…ØªÙˆØ³Ø·
                        <br /><small>Ù‚Ø±Ø§Ø¦Ù† ØºÙŠØ± Ù…Ø¨Ø§Ø´Ø±Ø©</small>
                    </button>
                    <button class="level-btn" data-level="3">
                        ğŸ† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø« - Ù…ØªÙ‚Ø¯Ù…
                        <br /><small>ÙÙ‚Ø±Ø§Øª Ø£Ø·ÙˆÙ„ + ØªØ¨Ø±ÙŠØ±</small>
                    </button>
                </div>
                <button id="start-btn" class="start-btn hidden">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨ ğŸš€</button>
            </div>

            <div id="game-area" class="game-area">
                <div class="stats">
                    <div class="score">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
                    <div>Ø§Ù„Ø³Ø¤Ø§Ù„ <span id="current-q">1</span> Ù…Ù† <span id="total-q">6</span></div>
                </div>

                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                </div>

                <div id="passage-area" class="passage-area card"></div>

                <div id="options-area" class="options-area"></div>

                <div id="evidence-area" class="hidden">
                    <input type="text" id="evidence-input" class="evidence-input" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…ØªÙŠÙ† Ø¯Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„ÙÙ‚Ø±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
                </div>

                <div class="controls">
                    <button id="speak-btn" class="control-btn">ğŸ”Š Ø§Ù‚Ø±Ø£ Ø§Ù„Ù†Øµ</button>
                    <button id="hint-btn" class="control-btn">ğŸ’¡ ØªÙ„Ù…ÙŠØ­</button>
                    <button id="cues-btn" class="control-btn hidden">ğŸ“ Ø£Ø¸Ù‡Ø± Ø§Ù„Ø¯Ù„ÙŠÙ„</button>
                    <button id="check-btn" class="control-btn check-btn">âœ… ØªØ­Ù‚Ù‚</button>
                </div>

                <div id="feedback" class="feedback" role="status"></div>

                <div class="controls">
                    <button id="next-btn" class="control-btn hidden">â¡ï¸ Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    <button id="restart-btn" class="control-btn">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
                </div>
            </div>
        </div>

        <div class="footer">ØµÙ†Ø¹ Ø¨Ø­Ø¨ Ù…Ù† kidskills â¤ï¸</div>

        <script>
            (function () {
                'use strict';

                // Game data
                const LEVEL1 = [
                    {
                        word: 'Ø®Ø§ÙØª',
                        passage: 'Ø¯Ø®Ù„ Ø§Ù„Ø·ÙÙ„ Ø¥Ù„Ù‰ ØºØ±ÙØ© Ù…Ø¸Ù„Ù…Ø© ØªÙ…Ø§Ù…Ù‹Ø§ØŒ Ø£Ø´Ø¹Ù„ Ù…ØµØ¨Ø§Ø­Ù‹Ø§ ØµØºÙŠØ±Ù‹Ø§ ÙØ¨Ø¯Ø£ ÙŠØ±Ù‰ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø¨ÙˆØ¶ÙˆØ­ ØªØ­Øª Ø¶ÙˆØ¦Ù‡ Ø§Ù„Ø®Ø§ÙØª.',
                        options: ['Ù‚ÙˆÙŠ Ø¬Ø¯Ù‹Ø§', 'Ø¶Ø¹ÙŠÙ', 'Ù…Ù„ÙˆÙ‘Ù†'],
                        answerIndex: 1,
                        hint: 'Ø§Ù‚Ø±Ø£ ÙƒÙ„Ù…Ø§Øª: Ù…Ø¸Ù„Ù…Ø©ØŒ Ù…ØµØ¨Ø§Ø­ ØµØºÙŠØ±â€¦ Ù…Ø§Ø°Ø§ ØªÙˆØ­ÙŠØŸ',
                        rationale: 'Ø§Ù„Ø¸Ù„Ø§Ù… ÙˆØ§Ù„Ù…ØµØ¨Ø§Ø­ Ø§Ù„ØµØºÙŠØ± ÙŠØ¯Ù„Ø§Ù† Ø¹Ù„Ù‰ Ø¶ÙˆØ¡ Ø¶Ø¹ÙŠÙ.',
                        emoji: 'ğŸ’¡',
                        difficulty: 1
                    },
                    {
                        word: 'Ø±Ø·Ø¨Ø©',
                        passage: 'Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø·Ø± Ø£ØµØ¨Ø­Øª Ø§Ù„Ø£Ø±Ø¶ Ø±Ø·Ø¨Ø© ÙˆØ§Ù…ØªÙ„Ø£Øª Ø§Ù„Ø¨Ø±Ùƒ Ø¨Ø§Ù„Ù…Ø§Ø¡.',
                        options: ['Ø¬Ø§ÙØ©', 'Ù…Ø¨Ù„Ù„Ø©', 'Ø­Ø§Ø±Ø©'],
                        answerIndex: 1,
                        hint: 'ÙÙƒØ± ÙÙŠ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…Ø·Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¶.',
                        rationale: 'Ø§Ù„Ù…Ø·Ø± ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø£Ø±Ø¶ Ù…Ø¨Ù„Ù„Ø© ÙˆØ±Ø·Ø¨Ø©.',
                        emoji: 'ğŸŒ§ï¸',
                        difficulty: 1
                    },
                    {
                        word: 'Ø¶Ø®Ù…',
                        passage: 'Ø­Ù…Ù„Ù†Ø§ ØµÙ†Ø¯ÙˆÙ‚Ù‹Ø§ ØµØºÙŠØ±Ù‹Ø§ØŒ Ù„ÙƒÙ† Ø§Ù„Ø­ÙˆØª Ø¶Ø®Ù… Ø¬Ø¯Ù‹Ø§ Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ù‡.',
                        options: ['Ù†Ø­ÙŠÙ', 'Ø³Ø±ÙŠØ¹', 'ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§'],
                        answerIndex: 2,
                        hint: 'Ù‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØµØºÙŠØ± ÙˆØ§Ù„Ø­ÙˆØª.',
                        rationale: 'Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØµØºÙŠØ± ØªØ¸Ù‡Ø± Ø£Ù† Ø§Ù„Ø­ÙˆØª ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§.',
                        emoji: 'ğŸ‹',
                        difficulty: 1
                    },
                    {
                        word: 'Ù‡Ø´',
                        passage: 'Ø§Ù†ÙƒØ³Ø± Ø§Ù„ØºØµÙ† Ø¨Ø³Ø±Ø¹Ø© Ù„Ø£Ù†Ù‡ Ù‡Ø´.',
                        options: ['Ù‚ÙˆÙŠ', 'Ø³Ù‡Ù„ Ø§Ù„ÙƒØ³Ø±', 'Ø·ÙˆÙŠÙ„'],
                        answerIndex: 1,
                        hint: 'Ù„Ù…Ø§Ø°Ø§ Ø§Ù†ÙƒØ³Ø± Ø§Ù„ØºØµÙ† Ø¨Ø³Ø±Ø¹Ø©ØŸ',
                        rationale: 'Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠÙ†ÙƒØ³Ø± Ø¨Ø³Ø±Ø¹Ø© ÙŠÙƒÙˆÙ† Ø³Ù‡Ù„ Ø§Ù„ÙƒØ³Ø± ÙˆÙ‡Ø´Ù‹Ø§.',
                        emoji: 'ğŸŒ¿',
                        difficulty: 1
                    },
                    {
                        word: 'Ù‡Ø§Ø¯Ø¦',
                        passage: 'Ø¨Ø¹Ø¯ Ø£Ù† Ù†Ø§Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„ ØµØ§Ø± Ø§Ù„Ø¨ÙŠØª Ù‡Ø§Ø¯Ø¦Ù‹Ø§.',
                        options: ['ØµØ§Ø®Ø¨', 'Ø¨Ø§Ø±Ø¯', 'ØºÙŠØ± Ù…Ø²Ø¹Ø¬'],
                        answerIndex: 2,
                        hint: 'Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ù„Ù„Ø¨ÙŠØª Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ†Ø§Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„ØŸ',
                        rationale: 'Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙ†Ø§Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙŠØµØ¨Ø­ Ø§Ù„Ø¨ÙŠØª Ù‡Ø§Ø¯Ø¦Ù‹Ø§ ÙˆØºÙŠØ± Ù…Ø²Ø¹Ø¬.',
                        emoji: 'ğŸ¤«',
                        difficulty: 1
                    },
                    {
                        word: 'Ù„Ø§Ù…Ø¹',
                        passage: 'Ù†Ø¸ÙØª Ø£Ù…ÙŠ Ø§Ù„Ù…Ø±Ø¢Ø© Ø­ØªÙ‰ Ø£ØµØ¨Ø­Øª Ù„Ø§Ù…Ø¹Ø© ØªØ¹ÙƒØ³ ÙˆØ¬Ù‡ÙŠ Ø¨ÙˆØ¶ÙˆØ­.',
                        options: ['Ù…ÙƒØ³ÙˆØ±Ø©', 'Ù…ØªØ³Ø®Ø©', 'Ø¨Ø±Ø§Ù‚'],
                        answerIndex: 2,
                        hint: 'Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ù„Ù„Ù…Ø±Ø¢Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙØŸ',
                        rationale: 'Ø§Ù„ØªÙ†Ø¸ÙŠÙ ÙŠØ¬Ø¹Ù„ Ø§Ù„Ù…Ø±Ø¢Ø© Ù„Ø§Ù…Ø¹Ø© ÙˆØ¨Ø±Ø§Ù‚Ø© ØªØ¹ÙƒØ³ Ø§Ù„ØµÙˆØ±Ø© Ø¨ÙˆØ¶ÙˆØ­.',
                        emoji: 'âœ¨',
                        difficulty: 1
                    },
                    {
                        word: 'Ø«Ù‚ÙŠÙ„',
                        passage: 'Ø­Ø§ÙˆÙ„ Ø§Ù„Ø±Ø¬Ù„ Ø±ÙØ¹ Ø§Ù„Ø­Ø¬Ø± Ù„ÙƒÙ†Ù‡ Ù„Ù… ÙŠØ³ØªØ·Ø¹ Ù„Ø£Ù†Ù‡ Ø«Ù‚ÙŠÙ„ Ø¬Ø¯Ù‹Ø§.',
                        options: ['Ø®ÙÙŠÙ', 'ØµØ¹Ø¨ Ø§Ù„Ø­Ù…Ù„', 'ØµØºÙŠØ±'],
                        answerIndex: 1,
                        hint: 'Ù„Ù…Ø§Ø°Ø§ Ù„Ù… ÙŠØ³ØªØ·Ø¹ Ø§Ù„Ø±Ø¬Ù„ Ø±ÙØ¹ Ø§Ù„Ø­Ø¬Ø±ØŸ',
                        rationale: 'Ø¹Ø¯Ù… Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø±ÙØ¹ Ø§Ù„Ø­Ø¬Ø± ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø£Ù†Ù‡ Ø«Ù‚ÙŠÙ„ ÙˆØµØ¹Ø¨ Ø§Ù„Ø­Ù…Ù„.',
                        emoji: 'ğŸª¨',
                        difficulty: 1
                    }
                ];

                const LEVEL2 = [
                    {
                        word: 'Ù‚Ø§Ø­Ù„',
                        passage: 'Ø³Ø§Ø±ÙˆØ§ Ø·ÙˆÙŠÙ„Ø§Ù‹ ÙÙŠ Ø³Ù‡Ù„Ù Ù‚Ø§Ø­Ù„Ø› Ù„Ø§ Ø£Ø´Ø¬Ø§Ø± ÙˆÙ„Ø§ Ø£Ù†Ù‡Ø§Ø±ØŒ ÙˆØ§Ù„Ø±ÙŠØ§Ø­ ØªØ­Ù…Ù„ ØºØ¨Ø§Ø±Ù‹Ø§ Ø¯Ù‚ÙŠÙ‚Ù‹Ø§.',
                        options: ['Ø¬Ø§Ù Ø¬Ø¯Ù‹Ø§', 'Ø¨Ø§Ø±Ø¯', 'Ù…Ø¸Ù„Ù…'],
                        answerIndex: 0,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ ØºÙŠØ§Ø¨ Ø§Ù„Ø£Ø´Ø¬Ø§Ø± ÙˆØ§Ù„Ø£Ù†Ù‡Ø§Ø± ÙˆØ§Ù„ØºØ¨Ø§Ø±.',
                        rationale: 'ØºÙŠØ§Ø¨ Ø§Ù„Ø£Ø´Ø¬Ø§Ø± ÙˆØ§Ù„Ø£Ù†Ù‡Ø§Ø± ÙˆØ§Ù„ØºØ¨Ø§Ø± ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙØ§Ù Ø§Ù„Ø´Ø¯ÙŠØ¯.',
                        emoji: 'ğŸœï¸',
                        difficulty: 2
                    },
                    {
                        word: 'Ø¹ØªÙŠÙ‚',
                        passage: 'ÙÙŠ Ø§Ù„Ù…ØªØ­Ù Ø´Ø§Ù‡Ø¯Ù†Ø§ ÙƒØ±Ø³ÙŠÙ‹Ø§ Ø¹ØªÙŠÙ‚Ù‹Ø§ ÙŠØ­Ù…Ù„ Ø¢Ø«Ø§Ø± Ø§Ù„Ø²Ù…Ù† ÙˆØ²Ø®Ø§Ø±Ù Ù‚Ø¯ÙŠÙ…Ø©.',
                        options: ['Ø­Ø¯ÙŠØ«', 'Ù‚Ø¯ÙŠÙ…', 'Ù…ØªØ³Ø®'],
                        answerIndex: 1,
                        hint: 'ÙÙƒØ± ÙÙŠ Ø§Ù„Ù…ØªØ­Ù ÙˆØ¢Ø«Ø§Ø± Ø§Ù„Ø²Ù…Ù† ÙˆØ§Ù„Ø²Ø®Ø§Ø±Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.',
                        rationale: 'Ø§Ù„Ù…ØªØ­Ù ÙˆØ¢Ø«Ø§Ø± Ø§Ù„Ø²Ù…Ù† ÙˆØ§Ù„Ø²Ø®Ø§Ø±Ù Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ØªØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙØ¯Ù….',
                        emoji: 'ğŸª‘',
                        difficulty: 2
                    },
                    {
                        word: 'Ù†Ø§Ø¯Ø±Ù‹Ø§',
                        passage: 'Ù‡Ùˆ ÙŠØ­Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ù„ÙƒÙ†Ù‡ Ù†Ø§Ø¯Ø±Ù‹Ø§ Ù…Ø§ ÙŠÙ„Ø¹Ø¨ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©.',
                        options: ['Ø¯Ø§Ø¦Ù…Ù‹Ø§', 'Ù‚Ù„ÙŠÙ„Ù‹Ø§', 'Ø¨Ø³Ø±Ø¹Ø©'],
                        answerIndex: 1,
                        hint: 'Ø±ØºÙ… Ø­Ø¨Ù‡ Ù„Ù„ÙƒØ±Ø©ØŒ Ù„Ø§ ÙŠÙ„Ø¹Ø¨ ÙƒØ«ÙŠØ±Ù‹Ø§ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø¯Ø±Ø§Ø³Ø©.',
                        rationale: 'Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ØªÙ…Ù†Ø¹Ù‡ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨ ÙƒØ«ÙŠØ±Ù‹Ø§ØŒ ÙÙŠÙ„Ø¹Ø¨ Ù‚Ù„ÙŠÙ„Ø§Ù‹ ÙÙ‚Ø·.',
                        emoji: 'âš½',
                        difficulty: 2
                    },
                    {
                        word: 'Ù…ÙÙŠØ¯',
                        passage: 'Ù‚Ø±Ø£Ù†Ø§ ÙƒØªØ§Ø¨Ù‹Ø§ Ù…ÙÙŠØ¯Ù‹Ø§Ø› ØªØ¹Ù„Ù‘Ù…Ù†Ø§ Ù…Ù†Ù‡ Ø·Ø±Ù‚ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ¦Ø©.',
                        options: ['Ù…Ù…ØªØ¹ ÙÙ‚Ø·', 'ÙŠÙ†ÙØ¹ ÙˆÙŠÙÙÙŠØ¯', 'Ù‚ØµÙŠØ±'],
                        answerIndex: 1,
                        hint: 'Ù…Ø§Ø°Ø§ Ø­Ø¯Ø« Ø¨Ø¹Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙƒØªØ§Ø¨ØŸ',
                        rationale: 'Ø§Ù„ØªØ¹Ù„Ù… Ù…Ù† Ø§Ù„ÙƒØªØ§Ø¨ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø£Ù†Ù‡ Ù…ÙÙŠØ¯ ÙˆÙŠÙ†ÙØ¹.',
                        emoji: 'ğŸ“š',
                        difficulty: 2
                    },
                    {
                        word: 'Ø±Ø´ÙŠÙ‚',
                        passage: 'ÙŠÙ‚ÙØ² Ø§Ù„Ø±Ø§Ù‚Øµ Ø®Ø·ÙˆØ§Øª Ø®ÙÙŠÙØ© Ø¨Ø­Ø±ÙƒØ© Ø±Ø´ÙŠÙ‚Ø©.',
                        options: ['Ø«Ù‚ÙŠÙ„Ø©', 'Ø®ÙÙŠÙØ© Ø¬Ù…ÙŠÙ„Ø©', 'Ø¨Ø·ÙŠØ¦Ø©'],
                        answerIndex: 1,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ ÙˆØµÙ Ø§Ù„Ù‚ÙØ² ÙˆØ§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø®ÙÙŠÙØ©.',
                        rationale: 'Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø®ÙÙŠÙØ© ÙˆØ§Ù„Ù‚ÙØ² ÙŠØ¯Ù„Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø´Ø§Ù‚Ø© ÙˆØ§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬Ù…ÙŠÙ„Ø©.',
                        emoji: 'ğŸ©°',
                        difficulty: 2
                    },
                    {
                        word: 'Ø¹Ø§ØµÙ',
                        passage: 'Ø£ØºÙ„Ù‚Ù†Ø§ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¨Ø³Ø±Ø¹Ø© Ø¹Ù†Ø¯Ù…Ø§ Ø¨Ø¯Ø£ Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„Ø¹Ø§ØµÙ ÙŠÙ‡Ø² Ø§Ù„Ø£Ø´Ø¬Ø§Ø± Ø¨Ù‚ÙˆØ©.',
                        options: ['Ù‡Ø§Ø¯Ø¦', 'Ù…Ø¶Ø·Ø±Ø¨', 'Ø¨Ø§Ø±Ø¯'],
                        answerIndex: 1,
                        hint: 'Ù„Ù…Ø§Ø°Ø§ Ø£ÙØºÙ„Ù‚Øª Ø§Ù„Ù†ÙˆØ§ÙØ°ØŸ ÙˆÙ…Ø§Ø°Ø§ Ø­Ø¯Ø« Ù„Ù„Ø£Ø´Ø¬Ø§Ø±ØŸ',
                        rationale: 'Ù‡Ø² Ø§Ù„Ø£Ø´Ø¬Ø§Ø± Ø¨Ù‚ÙˆØ© ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„Ù…Ø¶Ø·Ø±Ø¨.',
                        emoji: 'ğŸ’¨',
                        difficulty: 2
                    },
                    {
                        word: 'ÙˆØ§ÙØ±',
                        passage: 'ÙƒØ§Ù† Ø§Ù„Ù…Ø­ØµÙˆÙ„ ÙˆØ§ÙØ±Ù‹Ø§ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…ØŒ Ù…Ù„Ø£ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ÙˆÙ† Ø¹Ø´Ø±Ø§Øª Ø§Ù„Ø£ÙƒÙŠØ§Ø³ Ø¨Ø§Ù„Ù‚Ù…Ø­.',
                        options: ['Ù‚Ù„ÙŠÙ„', 'ÙƒØ«ÙŠØ±', 'ØºØ§Ù„ÙŠ'],
                        answerIndex: 1,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙƒÙŠØ§Ø³ Ø§Ù„ØªÙŠ Ù…Ù„Ø£Ù‡Ø§ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ÙˆÙ†.',
                        rationale: 'Ù…Ù„Ø¡ Ø¹Ø´Ø±Ø§Øª Ø§Ù„Ø£ÙƒÙŠØ§Ø³ ÙŠØ¯Ù„ Ø¹Ù„Ù‰ ÙƒØ«Ø±Ø© Ø§Ù„Ù…Ø­ØµÙˆÙ„ ÙˆÙˆÙØ±ØªÙ‡.',
                        emoji: 'ğŸŒ¾',
                        difficulty: 2
                    }
                ];

                const LEVEL3 = [
                    {
                        word: 'Ù…ØªØ±Ø¯Ù‘Ø¯',
                        passage: 'Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø§Ø¨ Ø«Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø§Ø¹Ø©ØŒ ØªÙ‚Ø¯Ù‘Ù… Ø®Ø·ÙˆØ© ÙˆØªØ±Ø§Ø¬Ø¹ØŒ ÙƒØ§Ù† ÙˆØ¬Ù‡Ù‡ Ø­Ø§Ø¦Ø±Ù‹Ø§Ø› Ø¨Ø¯Ø§ Ù…ØªØ±Ø¯Ø¯Ù‹Ø§ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„.',
                        options: ['ØºÙŠØ± Ø­Ø§Ø³Ù…', 'Ø³Ø±ÙŠØ¹', 'Ø³Ø¹ÙŠØ¯'],
                        answerIndex: 0,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ ØªØµØ±ÙØ§ØªÙ‡: Ø§Ù„Ù†Ø¸Ø± Ù„Ù„Ø³Ø§Ø¹Ø©ØŒ Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„ØªØ±Ø§Ø¬Ø¹ØŒ Ø§Ù„Ø­ÙŠØ±Ø©.',
                        rationale: 'Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„ØªØ±Ø§Ø¬Ø¹ ÙˆØ§Ù„Ø­ÙŠØ±Ø© ØªØ¯Ù„ Ø¹Ù„Ù‰ Ø¹Ø¯Ù… Ø§Ù„Ø­Ø³Ù… ÙˆØ§Ù„ØªØ±Ø¯Ø¯.',
                        emoji: 'ğŸ¤”',
                        difficulty: 3
                    },
                    {
                        word: 'Ø´Ø§Ø­Ø·',
                        passage: 'Ø³Ù…Ø¹ Ø§Ù„Ù†Ø¯Ø§Ø¡ ÙØ§Ù†Ø·Ù„Ù‚ Ø´Ø§Ø­Ø·Ù‹Ø§ Ù„ÙŠÙ„Ø­Ù‚ Ø¨Ø§Ù„Ø­Ø§ÙÙ„Ø© Ù‚Ø¨Ù„ Ø£Ù† ØªØºØ§Ø¯Ø±.',
                        options: ['Ù…Ø³Ø±Ø¹ Ø¬Ø¯Ù‹Ø§', 'Ù…ØªØ¹Ø¨', 'Ø®Ø§Ø¦Ù'],
                        answerIndex: 0,
                        hint: 'Ù„Ù…Ø§Ø°Ø§ Ø§Ù†Ø·Ù„Ù‚ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©ØŸ ÙˆÙ…Ø§Ø°Ø§ ÙƒØ§Ù† ÙŠØ­Ø§ÙˆÙ„ Ø£Ù† ÙŠÙØ¹Ù„ØŸ',
                        rationale: 'Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ Ù„Ù„Ø­Ø§Ù‚ Ø¨Ø§Ù„Ø­Ø§ÙÙ„Ø© ÙŠØªØ·Ù„Ø¨ Ø³Ø±Ø¹Ø© Ø´Ø¯ÙŠØ¯Ø©.',
                        emoji: 'ğŸƒâ€â™‚ï¸',
                        difficulty: 3
                    },
                    {
                        word: 'Ù…ØºÙ…ÙˆØ±',
                        passage: 'Ø²Ø±Ø¹ÙˆØ§ Ø§Ù„Ø´Ø¬Ø±Ø© Ù‚Ø±Ø¨ Ø§Ù„Ù†Ù‡Ø±ØŒ ÙˆØ¨Ø¹Ø¯ Ø§Ù„ÙÙŠØ¶Ø§Ù† ØµØ§Ø± Ø§Ù„Ø¬Ø°Ø± Ù…ØºÙ…ÙˆØ±Ù‹Ø§ Ø¨Ø§Ù„Ù…Ø§Ø¡.',
                        options: ['Ù…ØºØ·Ù‰', 'Ø¨Ø¹ÙŠØ¯', 'Ù…Ø±ØªÙØ¹'],
                        answerIndex: 0,
                        hint: 'Ù…Ø§Ø°Ø§ ÙŠØ­Ø¯Ø« Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ù†Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„ÙÙŠØ¶Ø§Ù†ØŸ',
                        rationale: 'Ø§Ù„ÙÙŠØ¶Ø§Ù† ÙŠØºØ·ÙŠ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ù†Ù‡Ø± Ø¨Ø§Ù„Ù…Ø§Ø¡.',
                        emoji: 'ğŸŒŠ',
                        difficulty: 3
                    },
                    {
                        word: 'Ù…ØªÙˆÙ‡Ù‘Ø¬',
                        passage: 'Ø£Ø¶Ø§Ø¡Øª Ø§Ù„Ø¬Ù…Ø±Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ¬Ù‡ Ø§Ù„Ù…Ø®ÙŠÙ‘Ù… Ø¨Ø¶ÙˆØ¡ Ù…ØªÙˆÙ‡Ù‘Ø¬.',
                        options: ['Ø³Ø§Ø·Ø¹', 'Ø¨Ø§Ø±Ø¯', 'Ø±Ø·Ø¨'],
                        answerIndex: 0,
                        hint: 'ÙƒÙŠÙ ØªØ¶ÙŠØ¡ Ø§Ù„Ø¬Ù…Ø±Ø§ØªØŸ ÙˆÙ…Ø§ ØªØ£Ø«ÙŠØ±Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¬Ù‡ØŸ',
                        rationale: 'Ø§Ù„Ø¬Ù…Ø±Ø§Øª ØªØµØ¯Ø± Ø¶ÙˆØ¡Ù‹Ø§ Ø³Ø§Ø·Ø¹Ù‹Ø§ ÙˆÙ…ØªÙˆÙ‡Ø¬Ù‹Ø§ ÙŠØ¶ÙŠØ¡ Ø§Ù„Ù…ÙƒØ§Ù†.',
                        emoji: 'ğŸ”¥',
                        difficulty: 3
                    },
                    {
                        word: 'Ù…Ù‡Ø¬ÙˆØ±',
                        passage: 'Ù…Ø±Ø±Ù†Ø§ Ø¨Ù‚Ø±ÙŠØ© Ù…Ù‡Ø¬ÙˆØ±Ø©ØŒ Ø§Ù„Ø¨ÙŠÙˆØª ÙØ§Ø±ØºØ© ÙˆØ§Ù„Ø­Ø´Ø§Ø¦Ø´ ØªÙ†Ù…Ùˆ ÙÙŠ Ø§Ù„Ø´ÙˆØ§Ø±Ø¹ØŒ Ù„Ø§ ØµÙˆØª Ø¥Ù„Ø§ ØµÙˆØª Ø§Ù„Ø±ÙŠØ­.',
                        options: ['Ù…Ù„ÙŠØ¡ Ø¨Ø§Ù„Ù†Ø§Ø³', 'Ø®Ø§Ù„ÙŠ Ù…Ù† Ø§Ù„Ø³ÙƒØ§Ù†', 'Ø¬Ø¯ÙŠØ¯'],
                        answerIndex: 1,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ ÙˆØµÙ Ø§Ù„Ø¨ÙŠÙˆØª ÙˆØ§Ù„Ø´ÙˆØ§Ø±Ø¹ ÙˆØ§Ù„Ø£ØµÙˆØ§Øª.',
                        rationale: 'Ø§Ù„Ø¨ÙŠÙˆØª Ø§Ù„ÙØ§Ø±ØºØ© ÙˆØ§Ù„Ø­Ø´Ø§Ø¦Ø´ ÙÙŠ Ø§Ù„Ø´ÙˆØ§Ø±Ø¹ ØªØ¯Ù„ Ø¹Ù„Ù‰ ØªØ±Ùƒ Ø§Ù„Ù…ÙƒØ§Ù†.',
                        emoji: 'ğŸšï¸',
                        difficulty: 3
                    },
                    {
                        word: 'Ù…Ø¨Ù‡Ø±',
                        passage: 'ØµØ¹Ø¯Ù†Ø§ Ø¥Ù„Ù‰ Ù‚Ù…Ø© Ø§Ù„Ø¬Ø¨Ù„ ÙˆØ±Ø£ÙŠÙ†Ø§ Ù…Ù†Ø¸Ø±Ù‹Ø§ Ù…Ø¨Ù‡Ø±Ù‹Ø§Ø› Ø§Ù„Ø³Ø­Ø¨ ØªØ­ØªÙ†Ø§ ÙˆØ§Ù„Ø´Ù…Ø³ ØªØ´Ø±Ù‚ Ù…Ù† Ø¨Ø¹ÙŠØ¯ØŒ ÙØªØ­Ù†Ø§ Ø£ÙÙˆØ§Ù‡Ù†Ø§ Ù…Ù† Ø§Ù„Ø¯Ù‡Ø´Ø©.',
                        options: ['Ù…Ù…Ù„Ù‘', 'Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ù‹Ø§', 'Ù…Ø®ÙŠÙ'],
                        answerIndex: 1,
                        hint: 'ÙƒÙŠÙ ØªÙØ§Ø¹Ù„ÙˆØ§ Ù…Ø¹ Ø§Ù„Ù…Ù†Ø¸Ø±ØŸ Ù…Ø§Ø°Ø§ ÙØ¹Ù„ÙˆØ§ Ù…Ù† Ø§Ù„Ø¯Ù‡Ø´Ø©ØŸ',
                        rationale: 'ÙØªØ­ Ø§Ù„Ø£ÙÙˆØ§Ù‡ Ù…Ù† Ø§Ù„Ø¯Ù‡Ø´Ø© ÙŠØ¯Ù„ Ø¹Ù„Ù‰ Ø¬Ù…Ø§Ù„ Ø§Ù„Ù…Ù†Ø¸Ø± Ø§Ù„Ø±Ø§Ø¦Ø¹.',
                        emoji: 'ğŸ”ï¸',
                        difficulty: 3
                    },
                    {
                        word: 'Ù…ÙƒØªØ¦Ø¨',
                        passage: 'Ø¬Ù„Ø³ Ø§Ù„Ø·ÙÙ„ ÙˆØ­ÙŠØ¯Ù‹Ø§ ÙÙŠ Ø§Ù„Ø²Ø§ÙˆÙŠØ©ØŒ Ø±Ø£Ø³Ù‡ Ù…Ù†Ø®ÙØ¶ ÙˆØ¹ÙŠÙ†Ø§Ù‡ Ø­Ø²ÙŠÙ†ØªØ§Ù†ØŒ Ù„Ù… ÙŠÙ„Ø¹Ø¨ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ù‡ Ø§Ù„ÙŠÙˆÙ… ÙˆØ¨Ø¯Ø§ Ù…ÙƒØªØ¦Ø¨Ù‹Ø§.',
                        options: ['Ø³Ø¹ÙŠØ¯', 'Ø­Ø²ÙŠÙ† Ø¬Ø¯Ù‹Ø§', 'ØºØ§Ø¶Ø¨'],
                        answerIndex: 1,
                        hint: 'Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ÙŠØ© Ø§Ù„Ø¬Ù„ÙˆØ³ ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ø¹ÙŠÙ†ÙŠÙ† ÙˆØ¹Ø¯Ù… Ø§Ù„Ù„Ø¹Ø¨.',
                        rationale: 'Ø§Ù„Ø¬Ù„ÙˆØ³ ÙˆØ­ÙŠØ¯Ù‹Ø§ ÙˆØ§Ù„Ø¹ÙŠÙˆÙ† Ø§Ù„Ø­Ø²ÙŠÙ†Ø© ØªØ¯Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø§ÙƒØªØ¦Ø§Ø¨ Ø§Ù„Ø´Ø¯ÙŠØ¯.',
                        emoji: 'ğŸ˜¢',
                        difficulty: 3
                    }
                ];

                // Game state
                let currentLevel = 1;
                let currentItems = [];
                let currentItemIndex = 0;
                let score = 0;
                let selectedOption = -1;
                let attempts = 0;
                let audioContext;
                let focusMode = false;

                // DOM elements
                const levelSelection = document.getElementById('level-selection');
                const gameArea = document.getElementById('game-area');
                const startBtn = document.getElementById('start-btn');
                const passageArea = document.getElementById('passage-area');
                const optionsArea = document.getElementById('options-area');
                const evidenceArea = document.getElementById('evidence-area');
                const evidenceInput = document.getElementById('evidence-input');
                const feedback = document.getElementById('feedback');
                const scoreEl = document.getElementById('score');
                const currentQEl = document.getElementById('current-q');
                const totalQEl = document.getElementById('total-q');
                const progressFill = document.getElementById('progress-fill');

                // Initialize audio context
                function initAudio() {
                    if (!audioContext) {
                        audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    }
                }

                // Play buzzer sound
                function playBuzzer() {
                    initAudio();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);

                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.35);

                    oscillator.start();
                    oscillator.stop(audioContext.currentTime + 0.35);
                }

                // Play glitter sound
                function playGlitter() {
                    initAudio();
                    const frequencies = [600, 800, 1000, 1200];

                    frequencies.forEach((freq, index) => {
                        setTimeout(() => {
                            const oscillator = audioContext.createOscillator();
                            const gainNode = audioContext.createGain();

                            oscillator.connect(gainNode);
                            gainNode.connect(audioContext.destination);

                            oscillator.type = 'sine';
                            oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);

                            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.12);

                            oscillator.start();
                            oscillator.stop(audioContext.currentTime + 0.12);
                        }, index * 120);
                    });
                }

                // Speak passage using Speech Synthesis
                function speakPassage() {
                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance(currentItems[currentItemIndex].passage);
                        utterance.lang = 'ar-SA';
                        utterance.rate = 0.8;
                        utterance.pitch = 1.1;
                        speechSynthesis.speak(utterance);
                    }
                }

                // Toggle focus mode
                function toggleFocusMode() {
                    focusMode = !focusMode;
                    document.body.classList.toggle('focus-mode', focusMode);
                }

                // Initialize game
                function init() {
                    // Level selection
                    document.querySelectorAll('.level-btn').forEach((btn) => {
                        btn.addEventListener('click', () => {
                            document.querySelectorAll('.level-btn').forEach((b) => b.classList.remove('selected'));
                            btn.classList.add('selected');
                            currentLevel = parseInt(btn.dataset.level);
                            startBtn.classList.remove('hidden');
                        });
                    });

                    // Start button
                    startBtn.addEventListener('click', startGame);

                    // Control buttons
                    document.getElementById('speak-btn').addEventListener('click', speakPassage);
                    document.getElementById('hint-btn').addEventListener('click', showHint);
                    document.getElementById('cues-btn').addEventListener('click', showCues);
                    document.getElementById('check-btn').addEventListener('click', checkAnswer);
                    document.getElementById('next-btn').addEventListener('click', nextItem);
                    document.getElementById('restart-btn').addEventListener('click', restartGame);

                    // Keyboard shortcuts
                    document.addEventListener('keydown', (e) => {
                        if (gameArea.style.display === 'block') {
                            switch (e.key) {
                                case 'Enter':
                                    e.preventDefault();
                                    checkAnswer();
                                    break;
                                case ' ':
                                    e.preventDefault();
                                    speakPassage();
                                    break;
                                case '1':
                                    selectOption(0);
                                    break;
                                case '2':
                                    selectOption(1);
                                    break;
                                case '3':
                                    selectOption(2);
                                    break;
                            }
                        }
                    });
                }

                // Start game
                function startGame() {
                    const allItems = currentLevel === 1 ? LEVEL1 : currentLevel === 2 ? LEVEL2 : LEVEL3;

                    // Shuffle and pick 6 items
                    const shuffled = [...allItems].sort(() => Math.random() - 0.5);
                    currentItems = shuffled.slice(0, 6);

                    currentItemIndex = 0;
                    score = 0;

                    levelSelection.style.display = 'none';
                    gameArea.style.display = 'block';

                    updateStats();
                    renderCurrentItem();
                }

                // Update stats display
                function updateStats() {
                    scoreEl.textContent = score;
                    currentQEl.textContent = currentItemIndex + 1;
                    totalQEl.textContent = currentItems.length;

                    const progress = (currentItemIndex / currentItems.length) * 100;
                    progressFill.style.width = progress + '%';
                }

                // Render current item
                function renderCurrentItem() {
                    const item = currentItems[currentItemIndex];
                    attempts = 0;
                    selectedOption = -1;

                    // Render passage with highlighted word
                    const passageWithHighlight = item.passage.replace(new RegExp(item.word, 'g'), `<span class="highlight-word">${item.word}</span>`);
                    passageArea.innerHTML = `${item.emoji} ${passageWithHighlight}`;

                    // Render options
                    optionsArea.innerHTML = '';
                    item.options.forEach((option, index) => {
                        const btn = document.createElement('button');
                        btn.className = 'option-btn';
                        btn.textContent = option;
                        btn.onclick = () => selectOption(index);
                        optionsArea.appendChild(btn);
                    });

                    // Show evidence input for level 3
                    if (currentLevel === 3) {
                        evidenceArea.classList.remove('hidden');
                        evidenceInput.value = '';
                    } else {
                        evidenceArea.classList.add('hidden');
                    }

                    // Reset UI state
                    feedback.innerHTML = '';
                    feedback.className = 'feedback';
                    document.getElementById('cues-btn').classList.add('hidden');
                    document.getElementById('next-btn').classList.add('hidden');

                    updateStats();
                }

                // Select option
                function selectOption(index) {
                    selectedOption = index;
                    document.querySelectorAll('.option-btn').forEach((btn, i) => {
                        btn.classList.toggle('selected', i === index);
                    });
                }

                // Show hint
                function showHint() {
                    const item = currentItems[currentItemIndex];
                    feedback.innerHTML = `ğŸ’¡ ${item.hint}`;
                    feedback.className = 'feedback';
                }

                // Show cues (highlight context clues)
                function showCues() {
                    const item = currentItems[currentItemIndex];
                    let highlightedPassage = item.passage;

                    // Simple cue detection based on common patterns
                    const cuePatterns = [
                        /Ù…Ø¸Ù„Ù…Ø©|ØµØºÙŠØ±|Ù‚ÙˆÙŠ|Ø¶Ø¹ÙŠÙ/g,
                        /Ø§Ù„Ù…Ø·Ø±|Ù…Ø§Ø¡|Ø¬Ø§Ù|Ù…Ø¨Ù„Ù„/g,
                        /Ø§Ù†ÙƒØ³Ø±|Ø¨Ø³Ø±Ø¹Ø©|Ù‚ÙˆÙŠ|Ø¶Ø¹ÙŠÙ/g,
                        /Ù†Ø§Ù…|Ù‡Ø§Ø¯Ø¦|ØµØ§Ø®Ø¨/g,
                        /Ù„Ø§ Ø£Ø´Ø¬Ø§Ø±|Ù„Ø§ Ø£Ù†Ù‡Ø§Ø±|ØºØ¨Ø§Ø±/g,
                        /Ø¢Ø«Ø§Ø± Ø§Ù„Ø²Ù…Ù†|Ù‚Ø¯ÙŠÙ…/g,
                        /ØªØ¹Ù„Ù…Ù†Ø§|Ù†ÙØ¹|ÙØ§Ø¦Ø¯Ø©/g,
                        /Ø®ÙÙŠÙØ©|Ù‚ÙØ²|Ø±Ø´Ø§Ù‚Ø©/g,
                        /ØªÙ‚Ø¯Ù…|ØªØ±Ø§Ø¬Ø¹|Ø­Ø§Ø¦Ø±/g,
                        /Ø§Ù†Ø·Ù„Ù‚|Ù„ÙŠÙ„Ø­Ù‚|Ø³Ø±Ø¹Ø©/g,
                        /ÙØ§Ø±ØºØ©|Ø­Ø´Ø§Ø¦Ø´|ØµÙ…Øª/g
                    ];

                    cuePatterns.forEach((pattern) => {
                        highlightedPassage = highlightedPassage.replace(pattern, (match) => `<span class="highlight-cue">${match}</span>`);
                    });

                    const wordHighlight = highlightedPassage.replace(new RegExp(item.word, 'g'), `<span class="highlight-word">${item.word}</span>`);

                    passageArea.innerHTML = `${item.emoji} ${wordHighlight}`;
                }

                // Check answer
                function checkAnswer() {
                    if (selectedOption === -1) {
                        feedback.innerHTML = 'âš ï¸ Ø§Ø®ØªØ± Ø¥Ø¬Ø§Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹';
                        feedback.className = 'feedback error';
                        return;
                    }

                    const item = currentItems[currentItemIndex];
                    attempts++;

                    if (selectedOption === item.answerIndex) {
                        // Correct answer
                        if (attempts === 1) {
                            score++;
                        }

                        playGlitter();
                        passageArea.classList.add('glitter');

                        feedback.innerHTML = `âœ… Ù…Ù…ØªØ§Ø²! ${item.rationale}`;
                        feedback.className = 'feedback success';

                        setTimeout(() => {
                            passageArea.classList.remove('glitter');
                            nextItem();
                        }, 1200);
                    } else {
                        // Wrong answer
                        playBuzzer();

                        if (attempts === 1) {
                            // First attempt - show hint and allow retry
                            feedback.innerHTML = `âŒ ${item.hint}`;
                            feedback.className = 'feedback error';

                            // Highlight the sentence containing the word
                            const sentences = item.passage.split(/[.!?]/);
                            const targetSentence = sentences.find((s) => s.includes(item.word));
                            if (targetSentence) {
                                const highlighted = item.passage.replace(targetSentence, `<span class="highlight-cue">${targetSentence}</span>`);
                                const withWord = highlighted.replace(new RegExp(item.word, 'g'), `<span class="highlight-word">${item.word}</span>`);
                                passageArea.innerHTML = `${item.emoji} ${withWord}`;
                            }
                        } else {
                            // Second attempt - show answer and move on
                            feedback.innerHTML = `âŒ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${item.options[item.answerIndex]}. ${item.rationale}`;
                            feedback.className = 'feedback error';

                            // Show cues button for level 3
                            if (currentLevel === 3) {
                                document.getElementById('cues-btn').classList.remove('hidden');
                            }

                            setTimeout(() => {
                                nextItem();
                            }, 2500);
                        }
                    }
                }

                // Next item
                function nextItem() {
                    currentItemIndex++;

                    if (currentItemIndex >= currentItems.length) {
                        // Game finished
                        showResults();
                    } else {
                        renderCurrentItem();
                    }
                }

                // Show results
                function showResults() {
                    const percentage = Math.round((score / currentItems.length) * 100);
                    let message = '';
                    let emoji = '';

                    if (percentage >= 90) {
                        message = 'Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹! Ø£Ù†Øª Ø¨Ø·Ù„ ÙÙŠ ÙÙ‡Ù… Ø§Ù„Ù†ØµÙˆØµ!';
                        emoji = 'ğŸ†';
                    } else if (percentage >= 75) {
                        message = 'Ø£Ø­Ø³Ù†Øª! Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹!';
                        emoji = 'â­';
                    } else if (percentage >= 60) {
                        message = 'Ø¬ÙŠØ¯! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­Ø³Ù† Ø£ÙƒØ«Ø±!';
                        emoji = 'ğŸ‘';
                    } else {
                        message = 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! Ø³ØªØªØ­Ø³Ù† Ù…Ø¹ Ø§Ù„ØªØ¯Ø±ÙŠØ¨!';
                        emoji = 'ğŸ’ª';
                    }

                    feedback.innerHTML = `
                    ${emoji} Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!<br>
                    Ø§Ù„Ù†ØªÙŠØ¬Ø©: ${score} Ù…Ù† ${currentItems.length} (${percentage}%)<br>
                    ${message}
                `;
                    feedback.className = 'feedback success';

                    document.getElementById('next-btn').classList.add('hidden');
                    document.getElementById('restart-btn').textContent = 'ğŸ® Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                }

                // Restart game
                function restartGame() {
                    levelSelection.style.display = 'block';
                    gameArea.style.display = 'none';
                    document.getElementById('restart-btn').textContent = 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨';

                    // Reset level selection
                    document.querySelectorAll('.level-btn').forEach((btn) => btn.classList.remove('selected'));
                    startBtn.classList.add('hidden');

                    // Reset progress
                    progressFill.style.width = '0%';
                }

                // Make functions global for HTML onclick
                window.toggleFocusMode = toggleFocusMode;

                // Initialize when page loads
                document.addEventListener('DOMContentLoaded', init);
            })();
        </script>
    </body>
</html>

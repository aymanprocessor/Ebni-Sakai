<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Ù„Ø¹Ø¨Ø© ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</title>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');

            body {
                font-family: 'Cairo', sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                margin: 0;
                padding: 20px;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .game-container {
                background: rgba(255, 255, 255, 0.95);
                border-radius: 20px;
                padding: 30px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                text-align: center;
                max-width: 700px;
                width: 100%;
            }

            .game-title {
                color: #4a5568;
                font-size: 32px;
                font-weight: 700;
                margin-bottom: 20px;
            }

            .level-info {
                background: linear-gradient(135deg, #ff6b6b, #ee5a24);
                color: white;
                padding: 15px;
                border-radius: 15px;
                margin-bottom: 20px;
                font-size: 18px;
                font-weight: 600;
            }

            .progress-bar {
                background: #e2e8f0;
                height: 10px;
                border-radius: 5px;
                margin: 15px 0;
                overflow: hidden;
            }

            .progress-fill {
                background: linear-gradient(135deg, #4facfe, #00f2fe);
                height: 100%;
                transition: width 0.3s ease;
            }

            .main-display {
                width: 250px;
                height: 250px;
                border: 5px solid #4a90e2;
                border-radius: 20px;
                margin: 20px auto;
                display: flex;
                align-items: center;
                justify-content: center;
                background: white;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
                overflow: hidden;
                position: relative;
            }

            .main-display img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                border-radius: 15px;
            }

            .main-display.reference {
                border-color: #28a745;
                background: linear-gradient(135deg, #d4edda, #c3e6cb);
            }

            .emoji-display {
                font-size: 120px;
                line-height: 1;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 100%;
                height: 100%;
            }

            .question-mark {
                font-size: 120px;
                color: #4a90e2;
                font-weight: bold;
                animation: pulse 1.5s infinite;
            }

            @keyframes pulse {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.1);
                }
            }

            .timer {
                font-size: 36px;
                font-weight: 700;
                color: #e53e3e;
                margin: 15px 0;
                min-height: 45px;
                animation: countdown 1s infinite;
            }

            @keyframes countdown {
                0%,
                100% {
                    color: #e53e3e;
                }
                50% {
                    color: #ff6b6b;
                }
            }

            .display-title {
                font-size: 20px;
                font-weight: 600;
                color: #2d3748;
                margin: 15px 0;
            }

            .question-text {
                font-size: 22px;
                font-weight: 600;
                color: #2d3748;
                margin: 20px 0;
                line-height: 1.4;
            }

            .answer-buttons {
                display: flex;
                gap: 15px;
                justify-content: center;
                margin: 30px 0;
                flex-wrap: wrap;
                max-width: 100%;
            }

            .choice-btn {
                padding: 15px 20px;
                font-size: 16px;
                font-weight: 700;
                border: 3px solid #4a90e2;
                border-radius: 15px;
                cursor: pointer;
                transition: all 0.3s ease;
                min-width: 100px;
                min-height: 100px;
                background: white;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .choice-btn:hover {
                transform: translateY(-5px);
                box-shadow: 0 15px 25px rgba(0, 0, 0, 0.3);
                border-color: #2d3748;
                background: #f7fafc;
            }

            .choice-btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none;
            }

            .choice-btn.correct {
                border-color: #48bb78;
                background: #c6f6d5;
                animation: correctPulse 0.6s ease-in-out;
            }

            .choice-btn.wrong {
                border-color: #f56565;
                background: #fed7d7;
                animation: shake 0.6s ease-in-out;
            }

            @keyframes correctPulse {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.1);
                }
            }

            @keyframes shake {
                0%,
                100% {
                    transform: translateX(0);
                }
                25% {
                    transform: translateX(-10px);
                }
                75% {
                    transform: translateX(10px);
                }
            }

            .start-btn {
                background: linear-gradient(135deg, #667eea, #764ba2);
                color: white;
                padding: 25px 60px;
                font-size: 22px;
                font-weight: 700;
                border: none;
                border-radius: 50px;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            }

            .start-btn:hover {
                transform: translateY(-5px);
                box-shadow: 0 20px 35px rgba(0, 0, 0, 0.3);
            }

            .feedback {
                font-size: 24px;
                font-weight: 700;
                margin: 20px 0;
                padding: 15px;
                border-radius: 15px;
                min-height: 30px;
            }

            .correct {
                background: linear-gradient(135deg, #d4edda, #c3e6cb);
                color: #155724;
                animation: celebration 0.8s ease-in-out;
            }

            .incorrect {
                background: linear-gradient(135deg, #f8d7da, #f5c6cb);
                color: #721c24;
                animation: shake 0.6s ease-in-out;
            }

            @keyframes celebration {
                0%,
                100% {
                    transform: scale(1) rotate(0deg);
                }
                25% {
                    transform: scale(1.1) rotate(3deg);
                }
                75% {
                    transform: scale(1.1) rotate(-3deg);
                }
            }

            .level-complete {
                background: linear-gradient(135deg, #ffd700, #ffed4e);
                color: #744210;
                padding: 25px;
                border-radius: 20px;
                font-size: 24px;
                font-weight: 700;
                animation: bounce 1s infinite;
            }

            @keyframes bounce {
                0%,
                100% {
                    transform: translateY(0);
                }
                50% {
                    transform: translateY(-10px);
                }
            }

            .hidden {
                display: none;
            }

            .welcome-instructions {
                font-size: 18px;
                color: #4a5568;
                line-height: 1.6;
                margin: 20px 0;
                background: rgba(255, 255, 255, 0.8);
                padding: 20px;
                border-radius: 15px;
                border: 2px solid #e2e8f0;
            }

            .stats {
                background: rgba(74, 144, 226, 0.1);
                padding: 10px;
                border-radius: 10px;
                margin: 10px 0;
                font-size: 16px;
                color: #2d3748;
            }

            @media (max-width: 600px) {
                .main-display {
                    width: 200px;
                    height: 200px;
                }

                .answer-buttons {
                    gap: 10px;
                }

                .choice-btn {
                    min-width: 80px;
                    min-height: 80px;
                    padding: 10px;
                }

                .choice-btn img {
                    width: 50px !important;
                    height: 50px !important;
                }

                .choice-btn span {
                    font-size: 30px !important;
                }
            }
        </style>
    </head>
    <body>
        <div class="game-container">
            <h1 class="game-title">ğŸ§  Ù„Ø¹Ø¨Ø© ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</h1>

            <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
            <div id="welcome-screen">
                <div class="level-info">
                    <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„: Ø§Ù„Ø£Ø´ÙƒØ§Ù„ ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† ğŸ¨ (5 Ø«ÙˆØ§Ù†Ù)</div>
                    <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª ğŸ˜ (4 Ø«ÙˆØ§Ù†Ù)</div>
                    <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„ÙˆØ¬ÙˆÙ‡ ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Øª ğŸ˜Š (3 Ø«ÙˆØ§Ù†Ù)</div>
                </div>
                <div class="welcome-instructions">
                    <strong>ÙƒÙŠÙÙŠØ© Ø§Ù„Ù„Ø¹Ø¨:</strong><br />
                    1ï¸âƒ£ Ø³ØªØ¸Ù‡Ø± Ù„Ùƒ ØµÙˆØ±Ø© Ø£Ø³Ø§Ø³ÙŠØ© - Ø§Ø­ÙØ¸Ù‡Ø§ Ø¬ÙŠØ¯Ø§Ù‹!<br />
                    2ï¸âƒ£ Ø«Ù… Ø³ØªØ®ØªÙÙŠ ÙˆØªØ¸Ù‡Ø± Ø¹Ù„Ø§Ù…Ø© Ø§Ø³ØªÙÙ‡Ø§Ù…<br />
                    3ï¸âƒ£ Ø¨Ø¹Ø¯Ù‡Ø§ Ø³ØªØ¸Ù‡Ø± Ø¹Ø¯Ø© Ø®ÙŠØ§Ø±Ø§Øª<br />
                    4ï¸âƒ£ Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©<br />
                    5ï¸âƒ£ ÙƒÙ„ Ø´ÙƒÙ„ Ø£Ø³Ø§Ø³ÙŠ ÙŠØ¸Ù‡Ø± Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·!<br />
                    <strong>âœ¨ Ø§Ù„Ù„Ø¹Ø¨Ø© ØªØµØ¨Ø­ Ø£ØµØ¹Ø¨ Ù…Ø¹ ÙƒÙ„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø®Ø§Ø·Ø¦Ø©!</strong>
                </div>
                <button class="start-btn" onclick="startGame()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
            </div>

            <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù„Ø¹Ø¨ -->
            <div id="game-screen" class="hidden">
                <div class="level-info">
                    <span id="level-display">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1</span> -
                    <span id="round-display">Ø§Ù„Ø¬ÙˆÙ„Ø© 1 Ù…Ù† 5</span>
                </div>

                <div class="stats">
                    <span id="used-images-count">Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: 0</span> |
                    <span id="attempt-count">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©: 1</span>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>

                <div class="display-title" id="display-title">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ø§Ø­ÙØ¸Ù‡Ø§ Ø¬ÙŠØ¯Ø§Ù‹!</div>

                <div class="timer" id="timer">5</div>

                <div class="main-display reference" id="main-display">
                    <!-- Ø§Ù„ØµÙˆØ±Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
                </div>

                <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ -->
                <div id="question-section" class="hidden">
                    <div class="question-text">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªÙŠ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</div>

                    <div class="answer-buttons" id="answer-buttons">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>

                <div class="feedback" id="feedback"></div>
            </div>

            <!-- Ø´Ø§Ø´Ø© Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ -->
            <div id="level-complete-screen" class="hidden">
                <div class="level-complete" id="level-complete-message"></div>
                <button class="start-btn" onclick="nextLevel()" id="next-level-btn">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ ğŸ¯</button>
            </div>

            <!-- Ø´Ø§Ø´Ø© Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© -->
            <div id="game-complete-screen" class="hidden">
                <div class="level-complete">
                    ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰<br />
                    Ø£Ù†Øª Ø¨Ø·Ù„ Ø§Ù„Ø°Ø§ÙƒØ±Ø©! ğŸ†<br />
                    <div style="font-size: 18px; margin-top: 15px">Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±! ğŸŒŸ</div>
                </div>
                <button class="start-btn" onclick="restartGame()">Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ”„</button>
            </div>
        </div>

        <script>
            // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
            let currentLevel = 1;
            let currentRound = 1;
            let baseImageSrc = '';
            let gameTimer = null;
            let isGameRunning = false;
            let buttonsDisabled = false;
            let usedImages = new Set(); // Ø§Ø³ØªØ®Ø¯Ø§Ù… Set Ù„Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
            let currentChoices = [];
            let correctAnswerIndex = -1;
            let attemptCount = 0;
            let allLevelImages = new Set(); // Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ± ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ

            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª - ØµÙˆØ± ÙØ±ÙŠØ¯Ø© Ù„ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰
            const gameLevels = {
                1: {
                    name: 'Ø§Ù„Ø£Ø´ÙƒØ§Ù„ ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†',
                    displayTime: 5,
                    images: [
                        // Ø¯ÙˆØ§Ø¦Ø± Ù…Ù„ÙˆÙ†Ø©
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjgwIiBmaWxsPSIjZmY2YjZiIi8+PC9zdmc+',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjgwIiBmaWxsPSIjNDhjYWY1Ii8+PC9zdmc+',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjgwIiBmaWxsPSIjNDhiYjc4Ii8+PC9zdmc+',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMDAiIGN5PSIxMDAiIHI9IjgwIiBmaWxsPSIjZmZkNzAwIi8+PC9zdmc+',
                        // Ù…Ø±Ø¨Ø¹Ø§Øª Ù…Ù„ÙˆÙ†Ø©
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIxNjAiIGhlaWdodD0iMTYwIiBmaWxsPSIjOWY3YWVhIi8+PC9zdmc+',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIxNjAiIGhlaWdodD0iMTYwIiBmaWxsPSIjZmY2MzQ3Ii8+PC9zdmc+',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIxNjAiIGhlaWdodD0iMTYwIiBmaWxsPSIjNjM2NmYxIi8+PC9zdmc+',
                        // Ù…Ø«Ù„Ø«Ø§Øª Ù…Ù„ÙˆÙ†Ø©
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxODAsMTgwIDIwLDE4MCIgZmlsbD0iI2VkNTY1MyIvPjwvc3ZnPg==',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxODAsMTgwIDIwLDE4MCIgZmlsbD0iIzM0ZDM5OSIvPjwvc3ZnPg==',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxODAsMTgwIDIwLDE4MCIgZmlsbD0iI2Y2YWQ1NSIvPjwvc3ZnPg==',
                        // Ù†Ø¬ÙˆÙ… Ù…Ù„ÙˆÙ†Ø©
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxMjUsNzUgMTgwLDc1IDEzNSwxMTUgMTU1LDE3MCAxMDAsMTQwIDQ1LDE3MCA2NSwxMTUgMjAsNzUgNzUsNzUiIGZpbGw9IiNmZmNkMzQiLz48L3N2Zz4=',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxMjUsNzUgMTgwLDc1IDEzNSwxMTUgMTU1LDE3MCAxMDAsMTQwIDQ1LDE3MCA2NSwxMTUgMjAsNzUgNzUsNzUiIGZpbGw9IiNlZDY0YTYiLz48L3N2Zz4=',
                        'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cG9seWdvbiBwb2ludHM9IjEwMCwyMCAxMjUsNzUgMTgwLDc1IDEzNSwxMTUgMTU1LDE3MCAxMDAsMTQwIDQ1LDE3MCA2NSwxMTUgMjAsNzUgNzUsNzUiIGZpbGw9IiM4MWU2ZDkiLz48L3N2Zz4='
                    ]
                },
                2: {
                    name: 'Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª',
                    displayTime: 4,
                    images: ['ğŸ˜', 'ğŸ´', 'ğŸ ', 'ğŸ¦', 'ğŸ¸', 'ğŸ„', 'ğŸ¦’', 'ğŸ¨', 'ğŸ§', 'ğŸ¦†', 'ğŸ·', 'ğŸ°', 'ğŸ™', 'ğŸ¦€', 'ğŸ¢']
                },
                3: {
                    name: 'Ø§Ù„ÙˆØ¬ÙˆÙ‡ ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Øª',
                    displayTime: 3,
                    images: ['ğŸ˜Š', 'ğŸ˜', 'ğŸ¤”', 'ğŸ˜', 'ğŸ¤—', 'ğŸ ', 'ğŸš—', 'ğŸ“±', 'âš½', 'ğŸ¸', 'ğŸ', 'â­', 'ğŸŒº', 'ğŸ””', 'ğŸ¯']
                }
            };

            // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£ØµÙˆØ§Øª
            function playSuccessSound() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);

                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.4);
                } catch (e) {
                    console.log('Audio not available');
                }
            }

            function playFailSound() {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(150, audioContext.currentTime + 0.2);

                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch (e) {
                    console.log('Audio not available');
                }
            }

            // ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            function setButtonsDisabled(disabled) {
                buttonsDisabled = disabled;
                const buttons = document.querySelectorAll('.choice-btn');
                buttons.forEach((btn) => {
                    btn.disabled = disabled;
                });
            }

            // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function startGame() {
                document.getElementById('welcome-screen').classList.add('hidden');
                document.getElementById('game-screen').classList.remove('hidden');
                isGameRunning = true;
                currentLevel = 1;
                currentRound = 1;
                resetGameData();
                startNewRound();
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
            function resetGameData() {
                usedImages = new Set();
                allLevelImages = new Set(gameLevels[currentLevel].images);
                attemptCount = 0;
            }

            // Ø¨Ø¯Ø¡ Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©
            function startNewRound() {
                updateGameDisplay();
                resetFeedback();
                setButtonsDisabled(true);
                attemptCount = 0;

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ ØµÙˆØ± Ù…ØªØ§Ø­Ø©
                const availableImages = Array.from(allLevelImages).filter((img) => !usedImages.has(img));

                if (availableImages.length === 0) {
                    // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙˆØ±ØŒ Ø§Ù†ØªÙ‚Ù„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
                    completeLevel();
                    return;
                }

                // Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø£Ø³Ø§Ø³ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
                baseImageSrc = availableImages[Math.floor(Math.random() * availableImages.length)];
                usedImages.add(baseImageSrc);

                // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
                showBaseImage();
            }

            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            function showBaseImage() {
                const displayElement = document.getElementById('main-display');
                const titleElement = document.getElementById('display-title');
                const timerElement = document.getElementById('timer');

                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ø±Ø¶
                displayElement.className = 'main-display reference';

                // Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
                if (currentLevel === 1) {
                    displayElement.innerHTML = `<img src="${baseImageSrc}" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©">`;
                } else {
                    displayElement.innerHTML = `<div class="emoji-display">${baseImageSrc}</div>`;
                }

                titleElement.textContent = 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ø§Ø­ÙØ¸Ù‡Ø§ Ø¬ÙŠØ¯Ø§Ù‹!';

                // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø³Ø¤Ø§Ù„
                document.getElementById('question-section').classList.add('hidden');

                // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
                let timeLeft = gameLevels[currentLevel].displayTime;
                timerElement.textContent = timeLeft;

                // Ù…Ø³Ø­ Ø£ÙŠ Ù…Ø¤Ù‚Øª Ø³Ø§Ø¨Ù‚
                if (gameTimer) {
                    clearInterval(gameTimer);
                }

                gameTimer = setInterval(() => {
                    timeLeft--;
                    timerElement.textContent = timeLeft;

                    if (timeLeft <= 0) {
                        clearInterval(gameTimer);
                        gameTimer = null;
                        hideBaseImageAndShowQuestion();
                    }
                }, 1000);
            }

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„
            function hideBaseImageAndShowQuestion() {
                const displayElement = document.getElementById('main-display');
                const titleElement = document.getElementById('display-title');
                const timerElement = document.getElementById('timer');

                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¹Ø±Ø¶ Ø¹Ù„Ø§Ù…Ø© Ø§Ø³ØªÙÙ‡Ø§Ù…
                displayElement.className = 'main-display';
                displayElement.innerHTML = '<div class="question-mark">ØŸ</div>';
                titleElement.textContent = 'ØªØ°ÙƒØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©!';
                timerElement.textContent = '';

                // ØªØ­Ø¶ÙŠØ± ØµÙˆØ±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
                setTimeout(() => {
                    prepareTestImage();
                }, 2000);
            }

            // ØªØ­Ø¶ÙŠØ± ØµÙˆØ±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
            function prepareTestImage() {
                attemptCount++;
                const levelImages = gameLevels[currentLevel].images;

                // ØªØ­Ø¯ÙŠØ¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª (ÙŠØ²ÙŠØ¯ Ù…Ø¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª)
                let numChoices = Math.min(2 + attemptCount, 6);

                // ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
                // ÙÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ØŒ Ù‚Ø¯ Ù„Ø§ ØªÙƒÙˆÙ† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©
                const includeCorrectAnswer = attemptCount >= 2 || Math.random() < 0.3;

                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
                currentChoices = [];
                correctAnswerIndex = -1;

                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…Ø·Ù„ÙˆØ¨Ø©
                if (includeCorrectAnswer) {
                    correctAnswerIndex = Math.floor(Math.random() * numChoices);
                }

                for (let i = 0; i < numChoices; i++) {
                    if (i === correctAnswerIndex) {
                        // Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                        currentChoices.push(baseImageSrc);
                    } else {
                        // Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©
                        let wrongImage;
                        let attempts = 0;
                        do {
                            wrongImage = levelImages[Math.floor(Math.random() * levelImages.length)];
                            attempts++;
                        } while ((wrongImage === baseImageSrc || currentChoices.includes(wrongImage)) && attempts < 20);
                        currentChoices.push(wrongImage);
                    }
                }

                // Ø®Ù„Ø· Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
                shuffleArray(currentChoices);

                // ØªØ­Ø¯ÙŠØ« Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ù„Ø·
                if (includeCorrectAnswer) {
                    correctAnswerIndex = currentChoices.indexOf(baseImageSrc);
                }

                // Ø¹Ø±Ø¶ ØµÙˆØ±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ø³Ø¤Ø§Ù„
                showTestQuestion();
            }

            // Ø®Ù„Ø· Ø§Ù„Ù…ØµÙÙˆÙØ©
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            // Ø¹Ø±Ø¶ Ø³Ø¤Ø§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
            function showTestQuestion() {
                const titleElement = document.getElementById('display-title');
                const questionSection = document.getElementById('question-section');
                const answerButtons = document.getElementById('answer-buttons');

                titleElement.textContent = 'Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©';

                // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
                answerButtons.innerHTML = '';

                currentChoices.forEach((choice, index) => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.onclick = () => selectChoice(index);

                    if (currentLevel === 1) {
                        button.innerHTML = `<img src="${choice}" alt="Ø§Ø®ØªÙŠØ§Ø± ${index + 1}" style="width: 70px; height: 70px; object-fit: contain; border-radius: 8px;">`;
                    } else {
                        button.innerHTML = `<span style="font-size: 50px;">${choice}</span>`;
                    }

                    answerButtons.appendChild(button);
                });

                // Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                questionSection.classList.remove('hidden');
                setButtonsDisabled(false);
            }

            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            function selectChoice(choiceIndex) {
                if (!isGameRunning || buttonsDisabled) return;

                setButtonsDisabled(true);
                const feedbackElement = document.getElementById('feedback');
                const buttons = document.querySelectorAll('.choice-btn');

                if (choiceIndex === correctAnswerIndex) {
                    // Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
                    buttons[choiceIndex].classList.add('correct');
                    feedbackElement.textContent = 'ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰';
                    feedbackElement.className = 'feedback correct';
                    playSuccessSound();

                    // Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø³Ø¤Ø§Ù„
                    setTimeout(() => {
                        document.getElementById('question-section').classList.add('hidden');
                        proceedToNextRound();
                    }, 1500);
                } else {
                    // Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©
                    buttons[choiceIndex].classList.add('wrong');

                    if (correctAnswerIndex === -1) {
                        feedbackElement.textContent = `âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${attemptCount}`;
                    } else {
                        feedbackElement.textContent = `âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${attemptCount}`;
                        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©
                        if (correctAnswerIndex >= 0) {
                            buttons[correctAnswerIndex].classList.add('correct');
                        }
                    }

                    feedbackElement.className = 'feedback incorrect';
                    playFailSound();

                    setTimeout(() => {
                        // Ø¥Ø¹Ø§Ø¯Ø© Ù†ÙØ³ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø¹ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø£ÙƒØ«Ø±
                        resetFeedback();
                        prepareTestImage();
                    }, 2500);
                }
            }

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
            function proceedToNextRound() {
                currentRound++;

                if (currentRound > 5 || usedImages.size >= allLevelImages.size) {
                    // Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                    completeLevel();
                } else {
                    // Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                    startNewRound();
                }
            }

            // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            function completeLevel() {
                // Ù…Ø³Ø­ Ø£ÙŠ Ù…Ø¤Ù‚Øª
                if (gameTimer) {
                    clearInterval(gameTimer);
                    gameTimer = null;
                }

                document.getElementById('game-screen').classList.add('hidden');
                document.getElementById('level-complete-screen').classList.remove('hidden');

                const messageElement = document.getElementById('level-complete-message');
                const usedCount = usedImages.size;
                const totalCount = allLevelImages.size;

                messageElement.innerHTML = `
                ğŸ‰ Ø±Ø§Ø¦Ø¹! Ø£ÙƒÙ…Ù„Øª ${gameLevels[currentLevel].name}! ğŸ‰<br>
                <div style="font-size: 18px; margin-top: 10px;">
                    Ø§Ø³ØªØ®Ø¯Ù…Øª ${usedCount} Ù…Ù† ${totalCount} Ø´ÙƒÙ„ Ù…Ø®ØªÙ„Ù! ğŸ“Š
                </div>
            `;

                if (currentLevel >= 3) {
                    // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± "Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ" ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ø®ÙŠØ±
                    document.getElementById('next-level-btn').style.display = 'none';
                    setTimeout(() => {
                        completeGame();
                    }, 2000);
                } else {
                    document.getElementById('next-level-btn').style.display = 'inline-block';
                }
            }

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
            function nextLevel() {
                currentLevel++;
                currentRound = 1;
                resetGameData(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯

                if (currentLevel > 3) {
                    completeGame();
                } else {
                    document.getElementById('level-complete-screen').classList.add('hidden');
                    document.getElementById('game-screen').classList.remove('hidden');
                    startNewRound();
                }
            }

            // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function completeGame() {
                document.getElementById('level-complete-screen').classList.add('hidden');
                document.getElementById('game-complete-screen').classList.remove('hidden');
                isGameRunning = false;
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function restartGame() {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
                currentLevel = 1;
                currentRound = 1;
                isGameRunning = false;
                buttonsDisabled = false;
                baseImageSrc = '';
                usedImages = new Set();
                allLevelImages = new Set();
                currentChoices = [];
                correctAnswerIndex = -1;
                attemptCount = 0;

                // Ù…Ø³Ø­ Ø£ÙŠ Ù…Ø¤Ù‚Øª
                if (gameTimer) {
                    clearInterval(gameTimer);
                    gameTimer = null;
                }

                // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨
                document.getElementById('game-complete-screen').classList.add('hidden');
                document.getElementById('welcome-screen').classList.remove('hidden');

                // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
                document.getElementById('next-level-btn').style.display = 'inline-block';
            }

            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function updateGameDisplay() {
                document.getElementById('level-display').textContent = `Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${currentLevel}`;
                document.getElementById('round-display').textContent = `Ø§Ù„Ø¬ÙˆÙ„Ø© ${currentRound} Ù…Ù† 5`;
                document.getElementById('used-images-count').textContent = `Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: ${usedImages.size}/${allLevelImages.size}`;
                document.getElementById('attempt-count').textContent = `Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©: ${attemptCount || 1}`;

                const progress = ((currentRound - 1) / 5) * 100;
                document.getElementById('progress-fill').style.width = progress + '%';
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
            function resetFeedback() {
                const feedbackElement = document.getElementById('feedback');
                feedbackElement.textContent = '';
                feedbackElement.className = 'feedback';

                // Ø¥Ø²Ø§Ù„Ø© ÙØ¦Ø§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                const buttons = document.querySelectorAll('.choice-btn');
                buttons.forEach((btn) => {
                    btn.classList.remove('correct', 'wrong');
                });
            }

            // ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
            window.addEventListener('beforeunload', () => {
                if (gameTimer) {
                    clearInterval(gameTimer);
                }
            });
        </script>
    </body>
</html>

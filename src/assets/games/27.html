<!doctype html>
<html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Ù„Ø¹Ø¨Ø© Ø§Ù„ØªØªØ¨Ø¹ ÙˆØ§Ù„Ø±Ø³Ù… Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Cairo', 'Comic Sans MS', sans-serif;
                background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
                min-height: 100vh;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 10px;
            }

            .game-container {
                background: rgba(255, 255, 255, 0.98);
                border-radius: 25px;
                padding: 25px;
                max-width: 900px;
                width: 100%;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                border: 4px solid #fff;
            }

            .header {
                text-align: center;
                margin-bottom: 25px;
            }

            .title {
                font-size: 2.3rem;
                color: #2d3436;
                margin-bottom: 15px;
                font-weight: bold;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            }

            .stats {
                display: flex;
                justify-content: center;
                gap: 20px;
                margin-bottom: 20px;
                flex-wrap: wrap;
            }

            .stat-item {
                background: linear-gradient(45deg, #00b894, #00a085);
                color: white;
                padding: 12px 24px;
                border-radius: 20px;
                font-weight: bold;
                font-size: 1.1rem;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                min-width: 120px;
                text-align: center;
            }

            .progress-section {
                background: #f8f9fa;
                border-radius: 15px;
                padding: 15px;
                margin: 20px 0;
                border: 2px solid #e9ecef;
            }

            .progress-bar {
                background: #e9ecef;
                height: 12px;
                border-radius: 6px;
                overflow: hidden;
                margin-bottom: 8px;
            }

            .progress-fill {
                background: linear-gradient(90deg, #00b894, #74b9ff);
                height: 100%;
                width: 0%;
                transition: width 0.5s ease;
            }

            .progress-text {
                text-align: center;
                font-weight: bold;
                color: #636e72;
            }

            .drawing-area {
                background: #fff;
                border: 3px dashed #ddd;
                border-radius: 20px;
                margin: 25px auto;
                position: relative;
                width: 100%;
                max-width: 600px;
                height: 400px;
                box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
            }

            .drawing-canvas {
                width: 100%;
                height: 100%;
                border-radius: 17px;
                cursor: crosshair;
            }

            .dot {
                position: absolute;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                color: white;
                font-size: 12px;
                cursor: pointer;
                transition: all 0.3s ease;
                z-index: 10;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            }

            .dot:hover {
                transform: scale(1.3);
            }

            .dot.active {
                animation: dotPulse 1s ease-in-out infinite;
                transform: scale(1.2);
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
                border: 3px solid #ffd700;
            }

            .dot.completed {
                background: #00b894 !important;
                animation: dotSuccess 0.6s ease;
            }

            .dot.current {
                background: #ff6b6b !important;
                border: 3px solid #ffd700;
                box-shadow: 0 0 20px rgba(255, 107, 107, 0.6);
            }

            @keyframes dotPulse {
                0%,
                100% {
                    box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
                    transform: scale(1.2);
                }
                50% {
                    box-shadow: 0 0 25px rgba(255, 215, 0, 1);
                    transform: scale(1.4);
                }
            }

            @keyframes dotSuccess {
                0% {
                    transform: scale(1.2);
                }
                50% {
                    transform: scale(1.5) rotate(180deg);
                }
                100% {
                    transform: scale(1.2) rotate(360deg);
                }
            }

            .message-box {
                text-align: center;
                font-size: 1.3rem;
                font-weight: bold;
                color: #636e72;
                margin: 20px 0;
                padding: 15px;
                background: linear-gradient(45deg, #f8f9fa, #e9ecef);
                border-radius: 15px;
                border: 2px solid #dee2e6;
                min-height: 50px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .controls {
                text-align: center;
                margin: 25px 0;
            }

            .game-button {
                background: linear-gradient(45deg, #74b9ff, #0984e3);
                border: none;
                color: white;
                padding: 16px 32px;
                font-size: 1.2rem;
                border-radius: 25px;
                cursor: pointer;
                margin: 0 10px;
                transition: all 0.3s ease;
                font-weight: bold;
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
                font-family: inherit;
            }

            .game-button:hover:not(:disabled) {
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            }

            .game-button:disabled {
                opacity: 0.6;
                cursor: not-allowed;
                transform: none;
            }

            .game-button.reset {
                background: linear-gradient(45deg, #fd79a8, #e84393);
            }

            .success-popup {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(45deg, #00b894, #00a085);
                color: white;
                padding: 30px;
                border-radius: 20px;
                font-size: 1.5rem;
                font-weight: bold;
                text-align: center;
                z-index: 1000;
                box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
                animation: popupShow 0.5s ease;
            }

            @keyframes popupShow {
                0% {
                    transform: translate(-50%, -50%) scale(0.5);
                    opacity: 0;
                }
                100% {
                    transform: translate(-50%, -50%) scale(1);
                    opacity: 1;
                }
            }

            .confetti-piece {
                position: absolute;
                width: 8px;
                height: 8px;
                border-radius: 50%;
                animation: confettiAnimation 3s ease-out forwards;
            }

            @keyframes confettiAnimation {
                0% {
                    transform: translateY(0) rotate(0deg);
                    opacity: 1;
                }
                100% {
                    transform: translateY(100vh) rotate(720deg);
                    opacity: 0;
                }
            }

            @keyframes errorShake {
                0%,
                100% {
                    transform: translateX(0);
                }
                20% {
                    transform: translateX(-8px);
                }
                40% {
                    transform: translateX(8px);
                }
                60% {
                    transform: translateX(-5px);
                }
                80% {
                    transform: translateX(5px);
                }
            }

            @media (max-width: 600px) {
                .game-container {
                    padding: 15px;
                    margin: 5px;
                }

                .title {
                    font-size: 1.8rem;
                }

                .drawing-area {
                    height: 300px;
                }

                .dot {
                    width: 24px;
                    height: 24px;
                    font-size: 14px;
                }

                .game-button {
                    padding: 14px 24px;
                    font-size: 1rem;
                    margin: 5px;
                }
            }
        </style>
    </head>
    <body>
        <div class="game-container">
            <div class="header">
                <h1 class="title">ğŸ¨ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© ğŸ¨</h1>

                <div class="stats">
                    <div class="stat-item">Ø§Ù„Ø´ÙƒÙ„: <span id="shapeNum">1</span> / 10</div>
                    <div class="stat-item">Ø§Ù„Ù†Ø¬ÙˆÙ…: <span id="starCount">0</span> â­</div>
                </div>
            </div>

            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="gameProgress"></div>
                </div>
                <div class="progress-text" id="progressInfo">Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©</div>
            </div>

            <div class="message-box" id="gameMsg">Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ø¶ØºØ· "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù…" Ù„ØªØ¨Ø¯Ø£ Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹! âœï¸</div>

            <div class="drawing-area">
                <canvas class="drawing-canvas" id="drawingCanvas"></canvas>
            </div>

            <div class="controls">
                <button class="game-button" id="startDrawing" onclick="beginShape()">âœï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù…</button>
                <button class="game-button reset" id="restartGame" onclick="restartFromBeginning()">ğŸ”„ Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</button>
            </div>
        </div>

        <script>
            // Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø¨Ø³Ø·Ø©
            const gameData = {
                currentShape: 1,
                totalStars: 0,
                canvas: null,
                ctx: null,
                dots: [],
                currentDot: 0,
                isActive: false,
                audioCtx: null,
                completedDots: []
            };

            // Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙˆØ§Ø­Ø¯
            const geometricShapes = [
                {
                    name: 'Ù…Ø«Ù„Ø«',
                    points: [
                        [300, 140],
                        [240, 240],
                        [360, 240]
                    ]
                },
                {
                    name: 'Ù…Ø±Ø¨Ø¹',
                    points: [
                        [240, 160],
                        [360, 160],
                        [360, 240],
                        [240, 240]
                    ]
                },
                {
                    name: 'Ù…Ø³ØªØ·ÙŠÙ„',
                    points: [
                        [220, 180],
                        [380, 180],
                        [380, 240],
                        [220, 240]
                    ]
                },
                {
                    name: 'Ù…Ø¹ÙŠÙ†',
                    points: [
                        [300, 140],
                        [360, 200],
                        [300, 260],
                        [240, 200]
                    ]
                },
                {
                    name: 'Ø¯Ø§Ø¦Ø±Ø©',
                    points: [
                        [300, 140],
                        [340, 150],
                        [370, 180],
                        [380, 220],
                        [370, 260],
                        [340, 290],
                        [300, 300],
                        [260, 290],
                        [230, 260],
                        [220, 220],
                        [230, 180],
                        [260, 150]
                    ]
                },
                {
                    name: 'Ø®Ù…Ø§Ø³ÙŠ',
                    points: [
                        [300, 130],
                        [360, 160],
                        [340, 230],
                        [260, 230],
                        [240, 160]
                    ]
                },
                {
                    name: 'Ø³Ø¯Ø§Ø³ÙŠ',
                    points: [
                        [300, 130],
                        [350, 160],
                        [350, 220],
                        [300, 250],
                        [250, 220],
                        [250, 160]
                    ]
                },
                {
                    name: 'Ù†Ø¬Ù…Ø©',
                    points: [
                        [300, 120],
                        [310, 150],
                        [340, 150],
                        [320, 175],
                        [330, 205],
                        [300, 190],
                        [270, 205],
                        [280, 175],
                        [260, 150],
                        [290, 150]
                    ]
                },
                {
                    name: 'Ù‚Ù„Ø¨',
                    points: [
                        [300, 160],
                        [280, 140],
                        [260, 140],
                        [240, 160],
                        [240, 180],
                        [300, 240],
                        [360, 180],
                        [360, 160],
                        [340, 140],
                        [320, 140]
                    ]
                },
                {
                    name: 'Ø³Ù‡Ù…',
                    points: [
                        [300, 120],
                        [340, 160],
                        [320, 160],
                        [320, 240],
                        [280, 240],
                        [280, 160],
                        [260, 160]
                    ]
                }
            ];

            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
            function getCurrentShape() {
                return geometricShapes[gameData.currentShape - 1];
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµÙˆØª
            function initializeAudio() {
                try {
                    if (!gameData.audioCtx && (window.AudioContext || window.webkitAudioContext)) {
                        gameData.audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    }
                    if (gameData.audioCtx?.state === 'suspended') {
                        gameData.audioCtx.resume();
                    }
                } catch (e) {
                    console.log('Ø§Ù„ØµÙˆØª ØºÙŠØ± Ù…ØªØ§Ø­');
                }
            }

            // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª
            function playSound(type) {
                if (!gameData.audioCtx) return;

                try {
                    if (type === 'correct') {
                        // ØµÙˆØª Ø¬Ù„ÙŠØªØ± Ù„Ù„Ù†Ø¬Ø§Ø­
                        const frequencies = [523, 659, 784, 1047];
                        frequencies.forEach((freq, index) => {
                            setTimeout(() => {
                                const osc = gameData.audioCtx.createOscillator();
                                const gain = gameData.audioCtx.createGain();
                                osc.connect(gain);
                                gain.connect(gameData.audioCtx.destination);
                                osc.frequency.value = freq;
                                osc.type = 'sine';
                                gain.gain.setValueAtTime(0.1, gameData.audioCtx.currentTime);
                                gain.gain.exponentialRampToValueAtTime(0.01, gameData.audioCtx.currentTime + 0.3);
                                osc.start();
                                osc.stop(gameData.audioCtx.currentTime + 0.3);
                            }, index * 100);
                        });
                    } else if (type === 'wrong') {
                        // ØµÙˆØª Ø¨Ø§Ø² Ù„Ù„Ø®Ø·Ø£
                        const osc = gameData.audioCtx.createOscillator();
                        const gain = gameData.audioCtx.createGain();
                        osc.connect(gain);
                        gain.connect(gameData.audioCtx.destination);
                        osc.frequency.setValueAtTime(180, gameData.audioCtx.currentTime);
                        osc.frequency.exponentialRampToValueAtTime(90, gameData.audioCtx.currentTime + 0.4);
                        osc.type = 'sawtooth';
                        gain.gain.setValueAtTime(0.08, gameData.audioCtx.currentTime);
                        gain.gain.exponentialRampToValueAtTime(0.01, gameData.audioCtx.currentTime + 0.4);
                        osc.start();
                        osc.stop(gameData.audioCtx.currentTime + 0.4);
                    } else if (type === 'complete') {
                        // ØµÙˆØª Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø´ÙƒÙ„
                        const melody = [523, 659, 784, 1047, 1319];
                        melody.forEach((freq, index) => {
                            setTimeout(() => {
                                const osc = gameData.audioCtx.createOscillator();
                                const gain = gameData.audioCtx.createGain();
                                osc.connect(gain);
                                gain.connect(gameData.audioCtx.destination);
                                osc.frequency.value = freq;
                                osc.type = 'triangle';
                                gain.gain.setValueAtTime(0.08, gameData.audioCtx.currentTime);
                                gain.gain.exponentialRampToValueAtTime(0.01, gameData.audioCtx.currentTime + 0.4);
                                osc.start();
                                osc.stop(gameData.audioCtx.currentTime + 0.4);
                            }, index * 150);
                        });
                    }
                } catch (e) {
                    console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØµÙˆØª');
                }
            }

            // Ø¥Ø¹Ø¯Ø§Ø¯ Canvas
            function setupCanvas() {
                gameData.canvas = document.getElementById('drawingCanvas');
                gameData.ctx = gameData.canvas.getContext('2d');

                // Ø¶Ø¨Ø· Ø­Ø¬Ù… Canvas
                const container = gameData.canvas.parentElement;
                gameData.canvas.width = container.offsetWidth;
                gameData.canvas.height = container.offsetHeight;

                // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø³Ù…
                gameData.ctx.strokeStyle = '#ff6b6b';
                gameData.ctx.lineWidth = 4;
                gameData.ctx.lineCap = 'round';
                gameData.ctx.lineJoin = 'round';
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ù‚Ø§Ø·
            function createDots() {
                const shape = getCurrentShape();
                const container = document.querySelector('.drawing-area');

                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                container.querySelectorAll('.dot').forEach((dot) => dot.remove());

                gameData.dots = [];
                gameData.currentDot = 0;
                gameData.completedDots = [];

                shape.points.forEach((point, index) => {
                    const dot = document.createElement('div');
                    dot.className = 'dot';
                    dot.id = `dot_${index}`;
                    dot.style.left = point[0] - 10 + 'px';
                    dot.style.top = point[1] - 10 + 'px';
                    dot.style.backgroundColor = index === 0 ? '#ff6b6b' : '#74b9ff';
                    dot.textContent = index + 1;

                    if (index === 0) {
                        dot.classList.add('current', 'active');
                    }

                    dot.onclick = () => selectDot(index);
                    container.appendChild(dot);

                    gameData.dots.push({
                        element: dot,
                        x: point[0],
                        y: point[1],
                        index: index
                    });
                });
            }

            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Ù‚Ø·Ø©
            function selectDot(dotIndex) {
                if (!gameData.isActive) return;

                if (dotIndex === gameData.currentDot) {
                    // Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©
                    playSound('correct');

                    const dot = document.getElementById(`dot_${dotIndex}`);
                    dot.classList.add('completed');
                    dot.classList.remove('current', 'active');

                    gameData.completedDots.push(dotIndex);

                    // Ø±Ø³Ù… Ø®Ø· Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø·Ø©
                    if (gameData.currentDot > 0) {
                        drawLineToPoint(gameData.dots[dotIndex]);
                    } else {
                        // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø±Ø³Ù…
                        gameData.ctx.beginPath();
                        gameData.ctx.moveTo(gameData.dots[0].x, gameData.dots[0].y);
                    }

                    gameData.currentDot++;

                    if (gameData.currentDot < gameData.dots.length) {
                        // ØªÙ†Ø´ÙŠØ· Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                        const nextDot = document.getElementById(`dot_${gameData.currentDot}`);
                        nextDot.classList.add('current', 'active');
                        nextDot.style.backgroundColor = '#ff6b6b';

                        updateGameMessage(`Ù…Ù…ØªØ§Ø²! Ø§Ù„Ø¢Ù† Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… ${gameData.currentDot + 1} ğŸ¯`);
                    } else {
                        // Ø§ÙƒØªÙ…Ù„ Ø§Ù„Ø´ÙƒÙ„
                        completeShape();
                    }
                } else {
                    // Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©
                    playSound('wrong');
                    const dot = document.getElementById(`dot_${dotIndex}`);
                    dot.style.animation = 'errorShake 0.6s ease';

                    setTimeout(() => {
                        dot.style.animation = '';
                    }, 600);

                    updateGameMessage('ğŸ˜Š Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© âœ¨');
                }
            }

            // Ø±Ø³Ù… Ø®Ø· Ø¨ÙŠÙ† Ø§Ù„Ù†Ù‚Ø§Ø·
            function drawLineToPoint(targetDot) {
                gameData.ctx.lineTo(targetDot.x, targetDot.y);
                gameData.ctx.stroke();
            }

            // Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø´ÙƒÙ„
            function completeShape() {
                gameData.isActive = false;
                gameData.totalStars++;

                // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´ÙƒÙ„ Ø¨Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                const firstDot = gameData.dots[0];
                gameData.ctx.lineTo(firstDot.x, firstDot.y);
                gameData.ctx.stroke();

                // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­
                playSound('complete');
                showSuccessAnimation();
                createConfettiEffect();

                setTimeout(() => {
                    moveToNext();
                }, 2500);
            }

            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
            function showSuccessAnimation() {
                const shape = getCurrentShape();
                const popup = document.createElement('div');
                popup.className = 'success-popup';
                popup.innerHTML = `ğŸ‰ Ø±Ø§Ø¦Ø¹! Ø£ÙƒÙ…Ù„Øª Ø±Ø³Ù… ${shape.name}! ğŸ†`;
                document.body.appendChild(popup);

                setTimeout(() => {
                    if (popup.parentNode) {
                        popup.remove();
                    }
                }, 2500);
            }

            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø´ÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ
            function moveToNext() {
                if (gameData.currentShape < 10) {
                    gameData.currentShape++;
                    const nextShape = getCurrentShape();
                    updateGameMessage(`ğŸ¨ Ù…Ø³ØªØ¹Ø¯ Ù„Ø±Ø³Ù… ${nextShape.name}ØŸ`);
                    document.getElementById('startDrawing').textContent = 'â¡ï¸ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ';
                } else {
                    // Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
                    updateGameMessage('ğŸ‘‘ Ù…Ø¨Ø±ÙˆÙƒ! Ø£ÙƒÙ…Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ©! Ø£Ù†Øª Ø±Ø³Ø§Ù… Ù…Ø­ØªØ±Ù! ğŸ‘‘');
                    document.getElementById('startDrawing').textContent = 'ğŸ® Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯';
                    gameData.currentShape = 1;
                    updateGameDisplay();
                    document.getElementById('startDrawing').disabled = false;
                    return;
                }

                updateGameDisplay();
                document.getElementById('startDrawing').disabled = false;
            }

            // Ø¨Ø¯Ø¡ Ø±Ø³Ù… Ø§Ù„Ø´ÙƒÙ„
            function beginShape() {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ù…
                gameData.currentDot = 0;
                gameData.isActive = true;
                gameData.completedDots = [];

                // Ù…Ø³Ø­ Canvas
                gameData.ctx.clearRect(0, 0, gameData.canvas.width, gameData.canvas.height);

                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                createDots();

                const shape = getCurrentShape();
                updateGameMessage(`ğŸ¯ Ø§Ø±Ø³Ù… ${shape.name} - Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø·Ø© Ø±Ù‚Ù… 1!`);

                document.getElementById('startDrawing').disabled = true;
            }

            // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
            function updateGameMessage(text) {
                document.getElementById('gameMsg').textContent = text;
            }

            // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            function updateGameDisplay() {
                document.getElementById('shapeNum').textContent = gameData.currentShape;
                document.getElementById('starCount').textContent = gameData.totalStars;

                const totalProgress = ((gameData.currentShape - 1) / 10) * 100;
                document.getElementById('gameProgress').style.width = Math.min(100, totalProgress) + '%';

                document.getElementById('progressInfo').textContent = `Ø§Ù„Ø£Ø´ÙƒØ§Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© - Ø§Ù„Ø´ÙƒÙ„ ${gameData.currentShape}`;
            }

            // Ø¥Ù†Ø´Ø§Ø¡ ØªØ£Ø«ÙŠØ± Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ
            function createConfettiEffect() {
                const colors = ['#ff6b6b', '#74b9ff', '#00b894', '#fdcb6e', '#e17055', '#a29bfe'];

                for (let i = 0; i < 25; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti-piece';
                        confetti.style.position = 'fixed';
                        confetti.style.left = Math.random() * window.innerWidth + 'px';
                        confetti.style.top = '-10px';
                        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.animationDelay = Math.random() * 500 + 'ms';
                        confetti.style.zIndex = '999';
                        confetti.style.pointerEvents = 'none';

                        document.body.appendChild(confetti);

                        setTimeout(() => {
                            if (confetti.parentNode) {
                                confetti.remove();
                            }
                        }, 3000);
                    }, i * 50);
                }
            }

            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©
            function restartFromBeginning() {
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§Ù…Ù„Ø©
                gameData.currentShape = 1;
                gameData.totalStars = 0;
                gameData.currentDot = 0;
                gameData.isActive = false;
                gameData.completedDots = [];

                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                document
                    .querySelector('.drawing-area')
                    .querySelectorAll('.dot')
                    .forEach((dot) => dot.remove());

                if (gameData.ctx) {
                    gameData.ctx.clearRect(0, 0, gameData.canvas.width, gameData.canvas.height);
                }

                // Ø¥Ø²Ø§Ù„Ø© Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­
                document.querySelectorAll('.success-popup').forEach((popup) => {
                    if (popup.parentNode) {
                        popup.remove();
                    }
                });

                updateGameMessage('Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ø¶ØºØ· "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù…" Ù„ØªØ¨Ø¯Ø£ Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¨Ø¯Ø§Ø¹! âœï¸');
                document.getElementById('startDrawing').disabled = false;
                document.getElementById('startDrawing').textContent = 'âœï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù…';

                updateGameDisplay();
            }

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            function initializeGame() {
                setupCanvas();
                updateGameDisplay();
                initializeAudio();
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
            function handleResize() {
                if (gameData.canvas && gameData.ctx) {
                    const container = gameData.canvas.parentElement;
                    gameData.canvas.width = container.offsetWidth;
                    gameData.canvas.height = container.offsetHeight;
                }
            }

            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªÙØ§Ø¹Ù„
            document.addEventListener('click', initializeAudio, { once: true });
            document.addEventListener('touchstart', initializeAudio, { once: true });

            // ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            window.addEventListener('load', initializeGame);
            window.addEventListener('resize', handleResize);

            // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
            window.addEventListener('error', function (e) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©:', e.message);
            });
        </script>
    </body>
</html>
